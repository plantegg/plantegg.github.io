<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Linux,Ansible,">





  <link rel="alternate" href="/atom.xml" title="plantegg" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="ansible 命令使用手册什么是命令通道？有时候一些简单任务，没必要写复杂的playbook，所以大多时候我们可以通过ansible命令行来批量操控目标机器  当我们需要批量操作、查看一组机器，或者在这些机器上批量执行某个命令、修改某个文件，都可以通过命令通道在一台机器上批量并发完成对所有机器的操作 命令通道只是一个帮你将命令发送到多个目标机器，并将执行结果返回来给你的一个执行通道  使用场景">
<meta name="keywords" content="Linux,Ansible">
<meta property="og:type" content="article">
<meta property="og:title" content="ansible 命令使用手册">
<meta property="og:url" content="https://plantegg.github.io/2016/03/24/ansible 命令通道使用手册/index.html">
<meta property="og:site_name" content="plantegg">
<meta property="og:description" content="ansible 命令使用手册什么是命令通道？有时候一些简单任务，没必要写复杂的playbook，所以大多时候我们可以通过ansible命令行来批量操控目标机器  当我们需要批量操作、查看一组机器，或者在这些机器上批量执行某个命令、修改某个文件，都可以通过命令通道在一台机器上批量并发完成对所有机器的操作 命令通道只是一个帮你将命令发送到多个目标机器，并将执行结果返回来给你的一个执行通道  使用场景">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/plantegg/plantegg.github.io/images/oss/d502a11765273304abd673fb358b482a.png">
<meta property="og:updated_time" content="2024-11-25T12:25:31.386Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ansible 命令使用手册">
<meta name="twitter:description" content="ansible 命令使用手册什么是命令通道？有时候一些简单任务，没必要写复杂的playbook，所以大多时候我们可以通过ansible命令行来批量操控目标机器  当我们需要批量操作、查看一组机器，或者在这些机器上批量执行某个命令、修改某个文件，都可以通过命令通道在一台机器上批量并发完成对所有机器的操作 命令通道只是一个帮你将命令发送到多个目标机器，并将执行结果返回来给你的一个执行通道  使用场景">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/plantegg/plantegg.github.io/images/oss/d502a11765273304abd673fb358b482a.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://plantegg.github.io/2016/03/24/ansible 命令通道使用手册/">





  <title>ansible 命令使用手册 | plantegg</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  















  
  
    
  

  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">plantegg</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">java tcp mysql performance network docker Linux</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-categories"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://plantegg.github.io/2016/03/24/ansible 命令通道使用手册/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="twitter @plantegg">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="plantegg">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">ansible 命令使用手册</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-24T17:30:03+08:00">
                2016-03-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Ansible/" itemprop="url" rel="index">
                    <span itemprop="name">Ansible</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>次
            </span>
          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="ansible-命令使用手册"><a href="#ansible-命令使用手册" class="headerlink" title="ansible 命令使用手册"></a>ansible 命令使用手册</h1><h2 id="什么是命令通道？"><a href="#什么是命令通道？" class="headerlink" title="什么是命令通道？"></a>什么是命令通道？</h2><p>有时候一些简单任务，没必要写复杂的playbook，所以大多时候我们可以通过ansible命令行来批量操控目标机器</p>
<blockquote>
<p>当我们需要批量操作、查看一组机器，或者在这些机器上批量执行某个命令、修改某个文件，都可以通过命令通道在一台机器上批量并发完成对所有机器的操作</p>
<p>命令通道只是一个帮你将命令发送到多个目标机器，并将执行结果返回来给你的一个执行通道</p>
</blockquote>
<h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ul>
<li>执行一行命令就能看到几十台机器的负载情况</li>
<li>批量执行远程服务器上已经写好的Shell脚本</li>
<li>查看所有Web服务器最近10000行Log中有没有ERROR</li>
<li>查看所有DB服务器的内存使用情况</li>
<li>批量将所有Diamond服务器的某个端口从7000改成9000</li>
</ul>
<h2 id="开始准备"><a href="#开始准备" class="headerlink" title="开始准备"></a>开始准备</h2><blockquote>
<p>如果不想每次输入ssh密码的话请提前将本地公钥(~&#x2F;.ssh&#x2F;id_rsa.pub 没有的话 ssh-keygen生成一对)复制到目标机器的 ~&#x2F;.ssh&#x2F;authorized_keys 里面，否则每次执行命令都要输入密码</p>
</blockquote>
<h3 id="编写一个-hosts-ini-配置文件，内容如下"><a href="#编写一个-hosts-ini-配置文件，内容如下" class="headerlink" title="编写一个 hosts.ini 配置文件，内容如下:"></a>编写一个 hosts.ini 配置文件，内容如下:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[server]</span><br><span class="line">10.125.0.169 ansible_ssh_port=9999 #如果只有这台机器ssh走的是9999端口，其它没有设置的还是默认22端口</span><br><span class="line">10.125.3.33</span><br><span class="line">120.26.116.193  </span><br><span class="line"></span><br><span class="line">[worker]</span><br><span class="line">10.125.12.174</span><br><span class="line">10.125.14.238</span><br><span class="line"></span><br><span class="line">[target]</span><br><span class="line">10.125.192.40 </span><br><span class="line">10.125.7.151</span><br><span class="line">192.168.2.[101:107]</span><br></pre></td></tr></table></figure>

<p>server&#x2F;worker&#x2F;target表示将7台机器分成了三组，可以到所有7台机器执行同一个命令，也可以只在server&#x2F;worker&#x2F;target中的一组机器上执行某个命令.all代表所有7台机器</p>
<h2 id="运行命令行"><a href="#运行命令行" class="headerlink" title="运行命令行"></a>运行命令行</h2><h3 id="查看-hosts-ini-里面所有服务器的-uptime"><a href="#查看-hosts-ini-里面所有服务器的-uptime" class="headerlink" title="查看 hosts.ini 里面所有服务器的 uptime"></a>查看 hosts.ini 里面所有服务器的 uptime</h3><pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">	$ ansible -i hosts.ini all -m raw -a &quot; uptime  &quot; -u admin</span><br><span class="line">	/usr/bin/ansible -i hosts.ini all -m raw -a  uptime   -u admin</span><br><span class="line">	</span><br><span class="line">	success =&gt; 10.125.12.174 =&gt; rc=0 =&gt;</span><br><span class="line">	 11:10:50 up 27 days, 15:40,  1 user,  load average: 0.05, 0.03, 0.05</span><br><span class="line">	success =&gt; 120.26.116.193 =&gt; rc=0 =&gt;</span><br><span class="line">	 11:10:50 up 13 days, 21:07,  1 user,  load average: 0.00, 0.00, 0.00</span><br><span class="line"></span><br><span class="line">命令参数说明</span><br><span class="line"></span><br><span class="line">&gt;    __all:__  表示对hosts.ini里面的所有服务器执行后面的命令 </span><br><span class="line"></span><br><span class="line">&gt;    __-i:__   指定hosts.ini文件所在的位置</span><br><span class="line"></span><br><span class="line">&gt;    __-m raw -a:__ 指定需要执行的命令</span><br><span class="line"></span><br><span class="line">&gt;    __&quot; uptime &quot;__ 双引号里面写上需要执行的命令</span><br><span class="line"></span><br><span class="line">&gt;    __-u admin__ 表示通过用户名admin 去执行命令【如果没有做好免密码，请加上 -k 参数，会出来提示输入SSH密码】</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 查看 hosts.ini 里面 server 组服务器的 home目录下的文件结构</span><br><span class="line">	$ ansible -i hosts.ini server -m raw -a &quot; ls -lh ~/  &quot; -u admin</span><br><span class="line">	</span><br><span class="line">	/usr/bin/ansible -i hosts.ini server -m raw -a  ls -lh ~/   -u admin</span><br><span class="line">	</span><br><span class="line">	success =&gt; 10.125.0.169 =&gt; rc=0 =&gt;</span><br><span class="line">	total 12K</span><br><span class="line">	drwxr-xr-x  2 root  root  4.0K Nov 13 12:34 files</span><br><span class="line">	drwxr-xr-x 11 admin admin 4.0K Oct 20 10:49 tomcat</span><br><span class="line">	drwxr-xr-x  3 test  games 4.0K Nov 18 15:40 ansible-engine</span><br><span class="line">	success =&gt; 10.125.3.33 =&gt; rc=0 =&gt;</span><br><span class="line">	total 20K</span><br><span class="line">	-rw-------  1 admin admin 1.4K Nov 12 13:39 authorized_keys</span><br><span class="line">	drwxr-xr-x  2 root  root  4.0K Nov 12 16:24 engine</span><br><span class="line">	drwxr-xr-x  2 root  root  4.0K Nov 13 12:22 files</span><br><span class="line">	drwxr-xr-x 11 admin admin 4.0K Nov 18 15:43 tomcat</span><br><span class="line">	drwxr-xr-x  3 test  games 4.0K Nov 18 15:40 ansible-engine</span><br><span class="line"></span><br><span class="line">### 查看部分机器 hostname</span><br></pre></td></tr></table></figure>
</code></pre>
<h1 id="ansible-i-ccb-test-ini-192-168-2-10-m-shell-a-‘hostname-‘"><a href="#ansible-i-ccb-test-ini-192-168-2-10-m-shell-a-‘hostname-‘" class="headerlink" title="ansible -i ccb_test.ini 192.168.2.10* -m shell -a ‘hostname ‘"></a>ansible -i ccb_test.ini 192.168.2.10* -m shell -a ‘hostname ‘</h1><p>[WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details<br>192.168.2.100 | CHANGED | rc&#x3D;0 &gt;&gt;<br>az2-drds-100<br>192.168.2.106 | CHANGED | rc&#x3D;0 &gt;&gt;<br>az2-manager-106<br>192.168.2.101 | CHANGED | rc&#x3D;0 &gt;&gt;<br>az2-alisql-101<br>192.168.2.102 | CHANGED | rc&#x3D;0 &gt;&gt;<br>az2-alisql-102<br>192.168.2.105 | CHANGED | rc&#x3D;0 &gt;&gt;<br>az2-alisql-105<br>192.168.2.104 | CHANGED | rc&#x3D;0 &gt;&gt;<br>az2-alisql-104<br>192.168.2.103 | CHANGED | rc&#x3D;0 &gt;&gt;<br>az2-alisql-103<br>192.168.2.107 | CHANGED | rc&#x3D;0 &gt;&gt;<br>az2-manager-107</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 使用环境变量</span><br></pre></td></tr></table></figure>

<p>#config &#x2F;etc&#x2F;hosts<br>ansible -i $1 all -m shell -a  “ sed -i ‘&#x2F;registry&#x2F;d’ &#x2F;etc&#x2F;hosts “<br>ansible -i $1 all -m shell -a  “ echo ‘    registry’ &gt;&#x2F;etc&#x2F;hosts “<br>ansible -i $1 all -m shell -a “ echo ‘ <code>hostname</code>‘ &gt;&gt;&#x2F;etc&#x2F;hosts “<br>ansible -i $1 diamond -m shell -a “ echo ‘   jmenv.tbsite.net’ &gt;&gt; &#x2F;etc&#x2F;hosts “ -u root<br>&#x2F;&#x2F;修改机器hostname<br>ansible -i $1 all -m shell -a “ hostnamectl set-hostname&#x3D;’drds-‘ “ -u root<br>&#x2F;&#x2F;修改机器hostname -i<br>ansible -i $1 all -m shell -a “ echo ‘  drds-‘ &gt;&gt; &#x2F;etc&#x2F;hosts  “ -u root</p>
<p>&#x2F;&#x2F;hostname 修改机器名</p>
<h1 id="ansible-i-ccb-test-ini-192-168-2-101-m-hostname-a-“-name-x3D-az2-alisql-101-“"><a href="#ansible-i-ccb-test-ini-192-168-2-101-m-hostname-a-“-name-x3D-az2-alisql-101-“" class="headerlink" title="ansible -i ccb_test.ini 192.168.2.101 -m hostname -a “ name&#x3D;az2-alisql-101 “"></a>ansible -i ccb_test.ini 192.168.2.101 -m hostname -a “ name&#x3D;az2-alisql-101 “</h1><p>[WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details<br>192.168.2.101 | CHANGED &#x3D;&gt; {<br>    “ansible_facts”: {<br>        “ansible_domain”: “”,<br>        “ansible_fqdn”: “iZ2ze9aj0re2ggbqa4dgxkZ”,<br>        “ansible_hostname”: “az2-alisql-101”,<br>        “ansible_nodename”: “az2-alisql-101”,<br>        “discovered_interpreter_python”: “&#x2F;usr&#x2F;bin&#x2F;python”<br>    },<br>    “changed”: true,<br>    “name”: “az2-alisql-101”<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 管理系统service</span><br><span class="line"></span><br><span class="line">设置 docker daemon服务重新启动和开机自动启动</span><br></pre></td></tr></table></figure>

<h1 id="ansible-i-ccb-test-ini-192-168-2-101-m-service-a-“-name-x3D-docker-enabled-x3D-yes-state-x3D-restarted-“"><a href="#ansible-i-ccb-test-ini-192-168-2-101-m-service-a-“-name-x3D-docker-enabled-x3D-yes-state-x3D-restarted-“" class="headerlink" title="ansible -i ccb_test.ini 192.168.2.101 -m service -a “ name&#x3D;docker enabled&#x3D;yes state&#x3D;restarted “"></a>ansible -i ccb_test.ini 192.168.2.101 -m service -a “ name&#x3D;docker enabled&#x3D;yes state&#x3D;restarted “</h1><p>[WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details<br>192.168.2.101 | CHANGED &#x3D;&gt; {<br>    “ansible_facts”: {<br>        “discovered_interpreter_python”: “&#x2F;usr&#x2F;bin&#x2F;python”<br>    },<br>    “changed”: true,<br>    “enabled”: true,<br>    “name”: “docker”,<br>    “state”: “started”,<br>    “status”: {<br>        “ActiveEnterTimestamp”: “二 2020-05-12 19:03:57 CST”,<br>        “ActiveEnterTimestampMonotonic”: “1553024093129”,<br>        “ActiveExitTimestamp”: “二 2020-05-12 19:01:24 CST”,<br>        “ActiveExitTimestampMonotonic”: “1552870910912”,<br>        “ActiveState”: “active”,<br>        “After”: “systemd-journald.socket system.slice docker.socket firewalld.service containerd.service network-online.target basic.target”,<br>        “AllowIsolate”: “no”,<br>        “AmbientCapabilities”: “0”,<br>        “AssertResult”: “yes”,<br>        “AssertTimestamp”: “二 2020-05-12 19:03:57 CST”,<br>        “AssertTimestampMonotonic”: “1553023902297”,<br>        “Before”: “multi-user.target shutdown.target”,<br>        “BindsTo”: “containerd.service”,<br>        “BlockIOAccounting”: “no”,<br>        “BlockIOWeight”: “18446744073709551615”,<br>        “CPUAccounting”: “no”,<br>        “CPUQuotaPerSecUSec”: “infinity”,<br>        “CPUSchedulingPolicy”: “0”,<br>        “CPUSchedulingPriority”: “0”,<br>        “CPUSchedulingResetOnFork”: “no”,<br>        “CPUShares”: “18446744073709551615”,<br>        “CanIsolate”: “no”,<br>        “CanReload”: “yes”,<br>        “CanStart”: “yes”,<br>        “CanStop”: “yes”,<br>        “CapabilityBoundingSet”: “18446744073709551615”,<br>        “ConditionResult”: “yes”,<br>        “ConditionTimestamp”: “二 2020-05-12 19:03:57 CST”,<br>        “ConditionTimestampMonotonic”: “1553023902297”,<br>        “Conflicts”: “shutdown.target”,<br>        “ConsistsOf”: “docker.socket”,<br>        “ControlGroup”: “&#x2F;system.slice&#x2F;docker.service”,<br>        “ControlPID”: “0”,<br>        “DefaultDependencies”: “yes”,<br>        “Delegate”: “yes”,<br>        “Description”: “Docker Application Container Engine”,<br>        “DevicePolicy”: “auto”,<br>        “Documentation”: “<a href="https://docs.docker.com/" target="_blank" rel="noopener">https://docs.docker.com</a>“,<br>        “ExecMainCode”: “0”,<br>        “ExecMainExitTimestampMonotonic”: “0”,<br>        “ExecMainPID”: “16213”,<br>        “ExecMainStartTimestamp”: “二 2020-05-12 19:03:57 CST”,<br>        “ExecMainStartTimestampMonotonic”: “1553023907468”,<br>        “ExecMainStatus”: “0”,<br>        “ExecReload”: “{ path&#x3D;&#x2F;bin&#x2F;kill ; argv[]&#x3D;&#x2F;bin&#x2F;kill -s HUP $MAINPID ; ignore_errors&#x3D;no ; start_time&#x3D;[n&#x2F;a] ; stop_time&#x3D;[n&#x2F;a] ; pid&#x3D;0 ; code&#x3D;(null) ; status&#x3D;0&#x2F;0 }”,<br>        “ExecStart”: “{ path&#x3D;&#x2F;usr&#x2F;bin&#x2F;dockerd ; argv[]&#x3D;&#x2F;usr&#x2F;bin&#x2F;dockerd -H fd:&#x2F;&#x2F; -H tcp:&#x2F;&#x2F;0.0.0.0:2376 –data-root&#x3D;&#x2F;var&#x2F;lib&#x2F;docker –log-opt max-size&#x3D;50m –log-opt max-file&#x3D;3 –registry-mirror&#x3D;<a href="https://oqpc6eum.mirror.aliyuncs.com/" target="_blank" rel="noopener">https://oqpc6eum.mirror.aliyuncs.com</a> –containerd&#x3D;&#x2F;run&#x2F;containerd&#x2F;containerd.sock ; ignore_errors&#x3D;no ; start_time&#x3D;[n&#x2F;a] ; stop_time&#x3D;[n&#x2F;a] ; pid&#x3D;0 ; code&#x3D;(null) ; status&#x3D;0&#x2F;0 }”,<br>        “FailureAction”: “none”,<br>        “FileDescriptorStoreMax”: “0”,<br>        “FragmentPath”: “&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;docker.service”,<br>        “GuessMainPID”: “yes”,<br>        “IOScheduling”: “0”,<br>        “Id”: “docker.service”,<br>        “IgnoreOnIsolate”: “no”,<br>        “IgnoreOnSnapshot”: “no”,<br>        “IgnoreSIGPIPE”: “yes”,<br>        “InactiveEnterTimestamp”: “二 2020-05-12 19:03:43 CST”,<br>        “InactiveEnterTimestampMonotonic”: “1553009791884”,<br>        “InactiveExitTimestamp”: “二 2020-05-12 19:03:57 CST”,<br>        “InactiveExitTimestampMonotonic”: “1553023907496”,<br>        “JobTimeoutAction”: “none”,<br>        “JobTimeoutUSec”: “0”,<br>        “KillMode”: “process”,<br>        “KillSignal”: “15”,<br>        “LimitAS”: “18446744073709551615”,<br>        “LimitCORE”: “18446744073709551615”,<br>        “LimitCPU”: “18446744073709551615”,<br>        “LimitDATA”: “18446744073709551615”,<br>        “LimitFSIZE”: “18446744073709551615”,<br>        “LimitLOCKS”: “18446744073709551615”,<br>        “LimitMEMLOCK”: “65536”,<br>        “LimitMSGQUEUE”: “819200”,<br>        “LimitNICE”: “0”,<br>        “LimitNOFILE”: “18446744073709551615”,<br>        “LimitNPROC”: “18446744073709551615”,<br>        “LimitRSS”: “18446744073709551615”,<br>        “LimitRTPRIO”: “0”,<br>        “LimitRTTIME”: “18446744073709551615”,<br>        “LimitSIGPENDING”: “379870”,<br>        “LimitSTACK”: “18446744073709551615”,<br>        “LoadState”: “loaded”,<br>        “MainPID”: “16213”,<br>        “MemoryAccounting”: “no”,<br>        “MemoryCurrent”: “58327040”,<br>        “MemoryLimit”: “18446744073709551615”,<br>        “MountFlags”: “0”,<br>        “Names”: “docker.service”,<br>        “NeedDaemonReload”: “no”,<br>        “Nice”: “0”,<br>        “NoNewPrivileges”: “no”,<br>        “NonBlocking”: “no”,<br>        “NotifyAccess”: “main”,<br>        “OOMScoreAdjust”: “0”,<br>        “OnFailureJobMode”: “replace”,<br>        “PermissionsStartOnly”: “no”,<br>        “PrivateDevices”: “no”,<br>        “PrivateNetwork”: “no”,<br>        “PrivateTmp”: “no”,<br>        “ProtectHome”: “no”,<br>        “ProtectSystem”: “no”,<br>        “RefuseManualStart”: “no”,<br>        “RefuseManualStop”: “no”,<br>        “RemainAfterExit”: “no”,<br>        “Requires”: “docker.socket basic.target”,<br>        “Restart”: “always”,<br>        “RestartUSec”: “2s”,<br>        “Result”: “success”,<br>        “RootDirectoryStartOnly”: “no”,<br>        “RuntimeDirectoryMode”: “0755”,<br>        “SameProcessGroup”: “no”,<br>        “SecureBits”: “0”,<br>        “SendSIGHUP”: “no”,<br>        “SendSIGKILL”: “yes”,<br>        “Slice”: “system.slice”,<br>        “StandardError”: “inherit”,<br>        “StandardInput”: “null”,<br>        “StandardOutput”: “journal”,<br>        “StartLimitAction”: “none”,<br>        “StartLimitBurst”: “3”,<br>        “StartLimitInterval”: “60000000”,<br>        “StartupBlockIOWeight”: “18446744073709551615”,<br>        “StartupCPUShares”: “18446744073709551615”,<br>        “StatusErrno”: “0”,<br>        “StopWhenUnneeded”: “no”,<br>        “SubState”: “running”,<br>        “SyslogLevelPrefix”: “yes”,<br>        “SyslogPriority”: “30”,<br>        “SystemCallErrorNumber”: “0”,<br>        “TTYReset”: “no”,<br>        “TTYVHangup”: “no”,<br>        “TTYVTDisallocate”: “no”,<br>        “TasksAccounting”: “no”,<br>        “TasksCurrent”: “58”,<br>        “TasksMax”: “18446744073709551615”,<br>        “TimeoutStartUSec”: “0”,<br>        “TimeoutStopUSec”: “0”,<br>        “TimerSlackNSec”: “50000”,<br>        “Transient”: “no”,<br>        “TriggeredBy”: “docker.socket”,<br>        “Type”: “notify”,<br>        “UMask”: “0022”,<br>        “UnitFilePreset”: “disabled”,<br>        “UnitFileState”: “enabled”,<br>        “WantedBy”: “multi-user.target”,<br>        “Wants”: “network-online.target system.slice”,<br>        “WatchdogTimestamp”: “二 2020-05-12 19:03:57 CST”,<br>        “WatchdogTimestampMonotonic”: “1553024093096”,<br>        “WatchdogUSec”: “0”<br>    }<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 一次执行多个命令</span><br></pre></td></tr></table></figure>

<p>$ ansible -i hosts.ini server -m raw -a “ which nc ; find &#x2F;opt&#x2F;aliUDP&#x2F;logs&#x2F;  “ -u admin</p>
<p>&#x2F;usr&#x2F;bin&#x2F;ansible -i hosts.ini server -m raw -a  which nc ; find &#x2F;opt&#x2F;aliUDP&#x2F;logs&#x2F;   -u admin</p>
<p>FAILED &#x3D;&gt; 120.26.116.193 &#x3D;&gt; rc&#x3D;1 &#x3D;&gt;<br>which: no nc in (&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin)<br>find: &#x2F;opt&#x2F;aliUDP: No such file or directory</p>
<p>success &#x3D;&gt; 10.125.3.33 &#x3D;&gt; rc&#x3D;0 &#x3D;&gt;<br>&#x2F;usr&#x2F;bin&#x2F;nc<br>&#x2F;opt&#x2F;aliUDP&#x2F;logs&#x2F;<br>&#x2F;opt&#x2F;aliUDP&#x2F;logs&#x2F;ansible.log.bak<br>&#x2F;opt&#x2F;aliUDP&#x2F;logs&#x2F;ansible.log</p>
<p>success &#x3D;&gt; 10.125.0.169 &#x3D;&gt; rc&#x3D;0 &#x3D;&gt;<br>&#x2F;usr&#x2F;bin&#x2F;nc<br>&#x2F;opt&#x2F;aliUDP&#x2F;logs&#x2F;<br>&#x2F;opt&#x2F;aliUDP&#x2F;logs&#x2F;ansible.log.bak<br>&#x2F;opt&#x2F;aliUDP&#x2F;logs&#x2F;ansible.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">结果说明</span><br><span class="line"></span><br><span class="line">&gt;   其中  120.26.116.193 上没有命令 nc 和 /opt/aliUDP 文件夹所有执行失败，但是其他两台机器都正常返回了结果</span><br><span class="line"></span><br><span class="line">### Copy本地的某个文件到服务器上【前面的例子中都是单独在远程机器上执行的命令】</span><br></pre></td></tr></table></figure>

<p>$ ansible  -i hosts.ini server  -m copy -a “ src&#x3D;’~&#x2F;.ssh&#x2F;id_rsa.pub’ dest&#x3D;’&#x2F;tmp&#x2F;‘ owner&#x3D;admin “ -u admin</p>
<p>SUCCESS &#x3D;&gt; 120.26.116.193 &#x3D;&gt; {<br>    “changed”: true,<br>    “checksum”: “b12ccf236ab788bbaebd7159c563e97411389c9e”,<br>    “dest”: “&#x2F;tmp&#x2F;id_rsa.pub”,<br>    “gid”: 0,<br>    “group”: “root”,<br>    “md5sum”: “b6ba28284ab95aaa0f47602bdab49f46”,<br>    “mode”: “0644”,<br>    “owner”: “root”,<br>    “size”: 392,<br>    “src”: “&#x2F;root&#x2F;.ansible&#x2F;ansible-tmp-1449109886.94-70134064194486&#x2F;source”,<br>    “state”: “file”,<br>    “uid”: 0<br>}</p>
<p>SUCCESS &#x3D;&gt; 10.125.0.169 &#x3D;&gt; {<br>    “changed”: true,<br>    “checksum”: “b12ccf236ab788bbaebd7159c563e97411389c9e”,<br>    “dest”: “&#x2F;tmp&#x2F;id_rsa.pub”,<br>    “gid”: 500,<br>    “group”: “admin”,<br>    “md5sum”: “b6ba28284ab95aaa0f47602bdab49f46”,<br>    “mode”: “0664”,<br>    “owner”: “admin”,<br>    “size”: 392,<br>    “src”: “&#x2F;home&#x2F;admin&#x2F;.ansible&#x2F;ansible-tmp-1449109886.78-98797505042348&#x2F;source”,<br>    “state”: “file”,<br>    “uid”: 500<br>}</p>
<p>SUCCESS &#x3D;&gt; 10.125.3.33 &#x3D;&gt; {<br>    “changed”: true,<br>    “checksum”: “b12ccf236ab788bbaebd7159c563e97411389c9e”,<br>    “dest”: “&#x2F;tmp&#x2F;id_rsa.pub”,<br>    “gid”: 500,<br>    “group”: “admin”,<br>    “md5sum”: “b6ba28284ab95aaa0f47602bdab49f46”,<br>    “mode”: “0664”,<br>    “owner”: “admin”,<br>    “size”: 392,<br>    “src”: “&#x2F;home&#x2F;admin&#x2F;.ansible&#x2F;ansible-tmp-1449109886.81-269249309502640&#x2F;source”,<br>    “state”: “file”,<br>    “uid”: 500<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">参数说明</span><br><span class="line"></span><br><span class="line">&gt;    __-m copy -a:__ 指定这是 **copy** 的命令</span><br><span class="line">&gt;</span><br><span class="line">&gt;    __&quot;  src=&apos;~/.ssh/id_rsa.pub&apos; dest=&apos;/tmp/&apos; &quot;__ src表示本地文件 dest表示远程目标位置</span><br><span class="line"></span><br><span class="line">### 验证一下刚刚copy上去的文件的MD5值</span><br></pre></td></tr></table></figure>

<p>$ ansible  -i hosts.ini server  -m command -a “ md5sum &#x2F;tmp&#x2F;id_rsa.pub “ -u admin</p>
<p>success &#x3D;&gt; 10.125.0.169 &#x3D;&gt; rc&#x3D;0 &#x3D;&gt;<br>b6ba28284ab95aaa0f47602bdab49f46  &#x2F;tmp&#x2F;id_rsa.pub</p>
<p>success &#x3D;&gt; 10.125.3.33 &#x3D;&gt; rc&#x3D;0 &#x3D;&gt;<br>b6ba28284ab95aaa0f47602bdab49f46  &#x2F;tmp&#x2F;id_rsa.pub</p>
<p>success &#x3D;&gt; 120.26.116.193 &#x3D;&gt; rc&#x3D;0 &#x3D;&gt;<br>b6ba28284ab95aaa0f47602bdab49f46  &#x2F;tmp&#x2F;id_rsa.pub</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">结果说明</span><br><span class="line"></span><br><span class="line">&gt;   md5都是b6ba28284ab95aaa0f47602bdab49f46 跟本地的一致，说明成功复制到目标机器了</span><br><span class="line"></span><br><span class="line">### 执行远程服务器上已经写好的Shell脚本</span><br></pre></td></tr></table></figure>

<p>$ cat test.sh<br>#&#x2F;bin&#x2F;sh</p>
<p>ifconfig | grep ‘inet addr’<br>echo “————-“<br>uptime<br>echo “————-“<br>date</p>
<p>df -lh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">执行结果</span><br><span class="line"></span><br><span class="line">```shell</span><br><span class="line">$ ansible  -i hosts.ini server  -m command -a &quot; sh /tmp/test.sh &quot; -u admin</span><br><span class="line"></span><br><span class="line">/usr/bin/ansible -i hosts.ini server -m command -a  sh /tmp/test.sh  -u admin</span><br><span class="line"></span><br><span class="line">success =&gt; 10.125.3.33 =&gt; rc=0 =&gt;</span><br><span class="line">          inet addr:10.125.3.33  Bcast:10.125.15.255  Mask:255.255.240.0</span><br><span class="line">          inet addr:127.0.0.1  Mask:255.0.0.0</span><br></pre></td></tr></table></figure>

<h3 id="copy个人笔记本的公钥到服务器上，以后从笔记本登录服务器不再需要输入密码"><a href="#copy个人笔记本的公钥到服务器上，以后从笔记本登录服务器不再需要输入密码" class="headerlink" title="copy个人笔记本的公钥到服务器上，以后从笔记本登录服务器不再需要输入密码"></a>copy个人笔记本的公钥到服务器上，以后从笔记本登录服务器不再需要输入密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ansible -i ansible-hosts.ini all -m authorized_key -a &quot; user=admin key=\&quot;&#123;&#123; lookup(&apos;file&apos;, &apos;/tmp/id_rsa.pub&apos;) &#125;&#125; \&quot;  &quot; -u admin -k</span><br></pre></td></tr></table></figure>

<h3 id="Copying-files-between-different-folders-on-the-same-remote-machine"><a href="#Copying-files-between-different-folders-on-the-same-remote-machine" class="headerlink" title="Copying files between different folders on the same remote machine"></a>Copying files between different folders on the same remote machine</h3><p>You can also copy files between the various locations on the remote servers. You have to set the <strong>remote_src</strong> parameter to yes.</p>
<p>The following example copies the hello6 file in the &#x2F;tmp directory of the remote server and pastes it in the &#x2F;etc&#x2F; directory.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- hosts: blocks</span><br><span class="line">  tasks:</span><br><span class="line">  - name: Ansible copy files remote to remote</span><br><span class="line">    copy:</span><br><span class="line">      src: /tmp/hello6</span><br><span class="line">      dest: /etc</span><br><span class="line">      remote_src: yes</span><br></pre></td></tr></table></figure>

<p>or:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible blocks -m copy -a &quot;src=/tmp/hello6 dest=/tmp/hello7etc remote_src=yes&quot; -s -i inventory.ini</span><br></pre></td></tr></table></figure>

<h3 id="效率更高的-copy：synchronize"><a href="#效率更高的-copy：synchronize" class="headerlink" title="效率更高的 copy：synchronize"></a>效率更高的 copy：synchronize</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible -i xty_172.ini all -m synchronize -a &quot; src=/home/ren/docker.service dest=/usr/lib/systemd/system/docker.socket &quot; -u root</span><br></pre></td></tr></table></figure>

<h3 id="find-file"><a href="#find-file" class="headerlink" title="find_file"></a>find_file</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- hosts: all</span><br><span class="line"></span><br><span class="line">  tasks:</span><br><span class="line">    - name: find_file</span><br><span class="line">      find:</span><br><span class="line">        paths: /home/admin/.ssh/</span><br><span class="line">        patterns: &quot;*.rsa&quot;</span><br><span class="line">        recurse: no</span><br><span class="line">      register: file_name</span><br><span class="line"></span><br><span class="line">    - name: copy_file</span><br><span class="line">      fetch:</span><br><span class="line">        src: &quot;&#123;&#123; item.path &#125;&#125;&quot;</span><br><span class="line">        dest: /tmp/sshbak/</span><br><span class="line">        flat: no</span><br><span class="line">      with_items: &quot;&#123;&#123; file_name.files &#125;&#125;&quot;</span><br></pre></td></tr></table></figure>

<p>test</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook -i 127.0.0.1,  ./find_file.yaml</span><br></pre></td></tr></table></figure>

<h3 id="不使用-hosts-ini文件，从命令行中传入目标机的-ip-列表"><a href="#不使用-hosts-ini文件，从命令行中传入目标机的-ip-列表" class="headerlink" title="不使用 hosts.ini文件，从命令行中传入目标机的 ip 列表"></a>不使用 hosts.ini文件，从命令行中传入目标机的 ip 列表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ansible -i 10.125.0.169,10.125.192.40 all -e &quot;ansible_ssh_port=22&quot; -a &quot;uptime&quot; -u admin</span><br><span class="line"></span><br><span class="line">success =&gt; 10.125.192.40 =&gt; rc=0 =&gt;</span><br><span class="line"> 12:31:50 up 48 days, 17:01,  0 users,  load average: 0.13, 0.06, 0.05</span><br><span class="line"></span><br><span class="line">success =&gt; 10.125.0.169 =&gt; rc=0 =&gt;</span><br><span class="line"> 12:31:50 up 49 days,  2:25,  0 users,  load average: 0.00, 0.01, 0.05</span><br></pre></td></tr></table></figure>

<p>执行说明</p>
<blockquote>
<p>   -i 后面带入ip列表，注意每个IP后面一定要有 “,” 分割开来，all 关键字也是必须的</p>
</blockquote>
<blockquote>
<p>   -e 中ansible_ssh_port&#x3D;22表示ssh使用22端口（默认），如果ssh使用9999端口在这里将22改成9999即可</p>
</blockquote>
<h3 id="使用root-sudo权限来执行命令"><a href="#使用root-sudo权限来执行命令" class="headerlink" title="使用root sudo权限来执行命令"></a>使用root sudo权限来执行命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible -i 10.125.6.93, all -m  shell -a &quot; ls -lh /home/admin/&quot;    -u admin --become-user=root --ask-become-pass --become-method=sudo --become -k</span><br></pre></td></tr></table></figure>

<h3 id="给admin授权登录server不需要输入密码（也不知道admin的密码）"><a href="#给admin授权登录server不需要输入密码（也不知道admin的密码）" class="headerlink" title="给admin授权登录server不需要输入密码（也不知道admin的密码）"></a>给admin授权登录server不需要输入密码（也不知道admin的密码）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">通过 admin(已知密码) 以root 权限将本机pub key复制到server上的 /home/admin, 再通过admin账号登录server就不需要密码了：</span><br><span class="line">ansible -i 10.125.6.93, all -m  authorized_key -a &quot; user=admin key=\&quot;&#123;&#123; lookup(&apos;file&apos;, &apos;/home/ren/.ssh/id_rsa.pub&apos;) &#125;&#125; \&quot;  &quot; -u admin --become-user=root --ask-become-pass --become-method=sudo --become -k</span><br><span class="line"></span><br><span class="line">不需要密码就可以执行：</span><br><span class="line">ansible -i 10.125.6.93, all -m shell -a &quot; ls -lha /home/admin/  &quot; -u admin</span><br></pre></td></tr></table></figure>

<h3 id="fetch-将远程服务器上的public-key-读取到本地"><a href="#fetch-将远程服务器上的public-key-读取到本地" class="headerlink" title="fetch:将远程服务器上的public key 读取到本地"></a>fetch:将远程服务器上的public key 读取到本地</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ansible -i kfc.ini hadoop -m fetch -a &quot; src=/home/admin/.ssh/id_rsa.pub dest=./test/  &quot;  -u admin</span><br><span class="line"></span><br><span class="line">find test/ -type f | xargs cat &gt; ./authorized_keys</span><br><span class="line"></span><br><span class="line">#push all the public keys to the server</span><br><span class="line">ansible -i ~/ali/ansible-edas/kfc.ini hadoop -m  copy -a &quot; src=./authorized_keys dest=/home/admin/.ssh/authorized_keys mode=600  &quot; -u admin</span><br></pre></td></tr></table></figure>

<p>或者循环fetch：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">$cat</span> <span class="string">fetch.yaml</span> </span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">all</span>   </span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">list</span> <span class="string">the</span> <span class="string">files</span> <span class="string">in</span> <span class="string">the</span> <span class="string">folder</span></span><br><span class="line">      <span class="comment">#command: ls /u01/nmon/tpcc/ </span></span><br><span class="line">      <span class="attr">shell:</span> <span class="string">(cd</span> <span class="string">/remote;</span> <span class="string">find</span> <span class="string">.</span> <span class="string">-maxdepth</span> <span class="number">1</span> <span class="string">-type</span> <span class="string">f)</span> <span class="string">|</span> <span class="string">cut</span> <span class="string">-d'/'</span> <span class="string">-f2</span></span><br><span class="line">      <span class="attr">register:</span> <span class="string">dir_out</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">do</span> <span class="string">the</span> <span class="string">action</span></span><br><span class="line">      <span class="attr">fetch:</span> <span class="string">src=/u01/nmon/tpcc/&#123;&#123;item&#125;&#125;</span> <span class="string">dest=/home/aliyun/nmon_tpcc/</span> <span class="string">flat=no</span></span><br><span class="line">      <span class="attr">with_items:</span> <span class="string">"<span class="template-variable">&#123;&#123;dir_out.stdout_lines&#125;&#125;</span>"</span></span><br></pre></td></tr></table></figure>

<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">$ansible-playbook -i /home/aliyun/all.ini  fetch.yaml -u admin</span><br><span class="line"></span><br><span class="line">PLAY [all] *******************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [Gathering Facts] *******************************************************************************</span><br><span class="line">ok: [10.88.88.18]</span><br><span class="line">ok: [10.88.88.16]</span><br><span class="line">ok: [10.88.88.15]</span><br><span class="line">ok: [10.88.88.19]</span><br><span class="line">ok: [10.88.88.17]</span><br><span class="line">ok: [10.88.88.20]</span><br><span class="line"></span><br><span class="line">TASK [list the files in the folder] ******************************************************************</span><br><span class="line">changed: [10.88.88.15]</span><br><span class="line">changed: [10.88.88.16]</span><br><span class="line">changed: [10.88.88.17]</span><br><span class="line">changed: [10.88.88.18]</span><br><span class="line">changed: [10.88.88.19]</span><br><span class="line">changed: [10.88.88.20]</span><br><span class="line"></span><br><span class="line">TASK [do the action] *********************************************************************************</span><br><span class="line">changed: [10.88.88.15] =&gt; (item=uos15_200729_1108.nmon)</span><br><span class="line">changed: [10.88.88.18] =&gt; (item=uos18_200729_1107.nmon)</span><br><span class="line">changed: [10.88.88.16] =&gt; (item=uos16_200729_1106.nmon)</span><br><span class="line">changed: [10.88.88.19] =&gt; (item=adbpg2-PC_200729_1108.nmon)</span><br><span class="line">changed: [10.88.88.17] =&gt; (item=uos17_200729_1107.nmon)</span><br><span class="line">changed: [10.88.88.19] =&gt; (item=adbpg2-PC_200729_1936.nmon)</span><br><span class="line">changed: [10.88.88.20] =&gt; (item=adbpg-PC_200729_1110.nmon)</span><br><span class="line"></span><br><span class="line">PLAY RECAP *******************************************************************************************</span><br><span class="line">10.88.88.15                : ok=3    changed=2    unreachable=0    failed=0   </span><br><span class="line">10.88.88.16                : ok=3    changed=2    unreachable=0    failed=0   </span><br><span class="line">10.88.88.17                : ok=3    changed=2    unreachable=0    failed=0   </span><br><span class="line">10.88.88.18                : ok=3    changed=2    unreachable=0    failed=0   </span><br><span class="line">10.88.88.19                : ok=3    changed=2    unreachable=0    failed=0   </span><br><span class="line">10.88.88.20                : ok=3    changed=2    unreachable=0    failed=0</span><br></pre></td></tr></table></figure>

<h3 id="setup-获取机器配置、参数信息"><a href="#setup-获取机器配置、参数信息" class="headerlink" title="setup:获取机器配置、参数信息"></a>setup:获取机器配置、参数信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br></pre></td><td class="code"><pre><span class="line"># ansible -i 192.168.1.91, all -m setup -u admin</span><br><span class="line">192.168.1.91 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;ansible_all_ipv4_addresses&quot;: [</span><br><span class="line">            &quot;172.17.0.1&quot;, </span><br><span class="line">            &quot;192.168.0.91&quot;, </span><br><span class="line">            &quot;192.168.1.91&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;ansible_all_ipv6_addresses&quot;: [], </span><br><span class="line">        &quot;ansible_apparmor&quot;: &#123;</span><br><span class="line">            &quot;status&quot;: &quot;disabled&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_architecture&quot;: &quot;x86_64&quot;, </span><br><span class="line">        &quot;ansible_bios_date&quot;: &quot;04/01/2014&quot;, </span><br><span class="line">        &quot;ansible_bios_version&quot;: &quot;8c24b4c&quot;, </span><br><span class="line">        &quot;ansible_cmdline&quot;: &#123;</span><br><span class="line">            &quot;BOOT_IMAGE&quot;: &quot;/boot/vmlinuz-3.10.0-957.21.3.el7.x86_64&quot;, </span><br><span class="line">            &quot;LANG&quot;: &quot;en_US.UTF-8&quot;, </span><br><span class="line">            &quot;biosdevname&quot;: &quot;0&quot;, </span><br><span class="line">            &quot;console&quot;: &quot;ttyS0,115200n8&quot;, </span><br><span class="line">            &quot;crashkernel&quot;: &quot;auto&quot;, </span><br><span class="line">            &quot;idle&quot;: &quot;halt&quot;, </span><br><span class="line">            &quot;net.ifnames&quot;: &quot;0&quot;, </span><br><span class="line">            &quot;noibrs&quot;: true, </span><br><span class="line">            &quot;quiet&quot;: true, </span><br><span class="line">            &quot;rhgb&quot;: true, </span><br><span class="line">            &quot;ro&quot;: true, </span><br><span class="line">            &quot;root&quot;: &quot;UUID=1114fe9e-2309-4580-b183-d778e6d97397&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_date_time&quot;: &#123;</span><br><span class="line">            &quot;date&quot;: &quot;2020-07-15&quot;, </span><br><span class="line">            &quot;day&quot;: &quot;15&quot;, </span><br><span class="line">            &quot;epoch&quot;: &quot;1594796084&quot;, </span><br><span class="line">            &quot;hour&quot;: &quot;14&quot;, </span><br><span class="line">            &quot;iso8601&quot;: &quot;2020-07-15T06:54:44Z&quot;, </span><br><span class="line">            &quot;iso8601_basic&quot;: &quot;20200715T145444643628&quot;, </span><br><span class="line">            &quot;iso8601_basic_short&quot;: &quot;20200715T145444&quot;, </span><br><span class="line">            &quot;iso8601_micro&quot;: &quot;2020-07-15T06:54:44.643725Z&quot;, </span><br><span class="line">            &quot;minute&quot;: &quot;54&quot;, </span><br><span class="line">            &quot;month&quot;: &quot;07&quot;, </span><br><span class="line">            &quot;second&quot;: &quot;44&quot;, </span><br><span class="line">            &quot;time&quot;: &quot;14:54:44&quot;, </span><br><span class="line">            &quot;tz&quot;: &quot;CST&quot;, </span><br><span class="line">            &quot;tz_offset&quot;: &quot;+0800&quot;, </span><br><span class="line">            &quot;weekday&quot;: &quot;星期三&quot;, </span><br><span class="line">            &quot;weekday_number&quot;: &quot;3&quot;, </span><br><span class="line">            &quot;weeknumber&quot;: &quot;28&quot;, </span><br><span class="line">            &quot;year&quot;: &quot;2020&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_default_ipv4&quot;: &#123;</span><br><span class="line">            &quot;address&quot;: &quot;192.168.0.91&quot;, </span><br><span class="line">            &quot;alias&quot;: &quot;eth0&quot;, </span><br><span class="line">            &quot;broadcast&quot;: &quot;192.168.0.255&quot;, </span><br><span class="line">            &quot;gateway&quot;: &quot;192.168.0.253&quot;, </span><br><span class="line">            &quot;interface&quot;: &quot;eth0&quot;, </span><br><span class="line">            &quot;macaddress&quot;: &quot;00:16:3e:30:d9:a4&quot;, </span><br><span class="line">            &quot;mtu&quot;: 1500, </span><br><span class="line">            &quot;netmask&quot;: &quot;255.255.255.0&quot;, </span><br><span class="line">            &quot;network&quot;: &quot;192.168.0.0&quot;, </span><br><span class="line">            &quot;type&quot;: &quot;ether&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_default_ipv6&quot;: &#123;&#125;, </span><br><span class="line">        &quot;ansible_device_links&quot;: &#123;</span><br><span class="line">            &quot;ids&quot;: &#123;&#125;, </span><br><span class="line">            &quot;labels&quot;: &#123;</span><br><span class="line">                &quot;loop2&quot;: [</span><br><span class="line">                    &quot;CDROM&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;masters&quot;: &#123;&#125;, </span><br><span class="line">            &quot;uuids&quot;: &#123;</span><br><span class="line">                &quot;loop0&quot;: [</span><br><span class="line">                    &quot;2020-07-12-14-26-47-00&quot;</span><br><span class="line">                ], </span><br><span class="line">                &quot;loop1&quot;: [</span><br><span class="line">                    &quot;2020-07-12-20-25-18-00&quot;</span><br><span class="line">                ], </span><br><span class="line">                &quot;loop2&quot;: [</span><br><span class="line">                    &quot;2020-07-13-09-57-36-00&quot;</span><br><span class="line">                ], </span><br><span class="line">                &quot;vda1&quot;: [</span><br><span class="line">                    &quot;1114fe9e-2309-4580-b183-d778e6d97397&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_devices&quot;: &#123;</span><br><span class="line">            &quot;loop0&quot;: &#123;</span><br><span class="line">                &quot;holders&quot;: [], </span><br><span class="line">                &quot;host&quot;: &quot;&quot;, </span><br><span class="line">                &quot;links&quot;: &#123;</span><br><span class="line">                    &quot;ids&quot;: [], </span><br><span class="line">                    &quot;labels&quot;: [], </span><br><span class="line">                    &quot;masters&quot;: [], </span><br><span class="line">                    &quot;uuids&quot;: [</span><br><span class="line">                        &quot;2020-07-12-14-26-47-00&quot;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;, </span><br><span class="line">                &quot;model&quot;: null, </span><br><span class="line">                &quot;partitions&quot;: &#123;&#125;, </span><br><span class="line">                &quot;removable&quot;: &quot;0&quot;, </span><br><span class="line">                &quot;rotational&quot;: &quot;1&quot;, </span><br><span class="line">                &quot;sas_address&quot;: null, </span><br><span class="line">                &quot;sas_device_handle&quot;: null, </span><br><span class="line">                &quot;scheduler_mode&quot;: &quot;&quot;, </span><br><span class="line">                &quot;sectors&quot;: &quot;327924&quot;, </span><br><span class="line">                &quot;sectorsize&quot;: &quot;512&quot;, </span><br><span class="line">                &quot;size&quot;: &quot;160.12 MB&quot;, </span><br><span class="line">                &quot;support_discard&quot;: &quot;4096&quot;, </span><br><span class="line">                &quot;vendor&quot;: null, </span><br><span class="line">                &quot;virtual&quot;: 1</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;loop1&quot;: &#123;</span><br><span class="line">                &quot;holders&quot;: [], </span><br><span class="line">                &quot;host&quot;: &quot;&quot;, </span><br><span class="line">                &quot;links&quot;: &#123;</span><br><span class="line">                    &quot;ids&quot;: [], </span><br><span class="line">                    &quot;labels&quot;: [], </span><br><span class="line">                    &quot;masters&quot;: [], </span><br><span class="line">                    &quot;uuids&quot;: [</span><br><span class="line">                        &quot;2020-07-12-20-25-18-00&quot;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;, </span><br><span class="line">                &quot;model&quot;: null, </span><br><span class="line">                &quot;partitions&quot;: &#123;&#125;, </span><br><span class="line">                &quot;removable&quot;: &quot;0&quot;, </span><br><span class="line">                &quot;rotational&quot;: &quot;1&quot;, </span><br><span class="line">                &quot;sas_address&quot;: null, </span><br><span class="line">                &quot;sas_device_handle&quot;: null, </span><br><span class="line">                &quot;scheduler_mode&quot;: &quot;&quot;, </span><br><span class="line">                &quot;sectors&quot;: &quot;359172&quot;, </span><br><span class="line">                &quot;sectorsize&quot;: &quot;512&quot;, </span><br><span class="line">                &quot;size&quot;: &quot;175.38 MB&quot;, </span><br><span class="line">                &quot;support_discard&quot;: &quot;4096&quot;, </span><br><span class="line">                &quot;vendor&quot;: null, </span><br><span class="line">                &quot;virtual&quot;: 1</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;loop2&quot;: &#123;</span><br><span class="line">                &quot;holders&quot;: [], </span><br><span class="line">                &quot;host&quot;: &quot;&quot;, </span><br><span class="line">                &quot;links&quot;: &#123;</span><br><span class="line">                    &quot;ids&quot;: [], </span><br><span class="line">                    &quot;labels&quot;: [</span><br><span class="line">                        &quot;CDROM&quot;</span><br><span class="line">                    ], </span><br><span class="line">                    &quot;masters&quot;: [], </span><br><span class="line">                    &quot;uuids&quot;: [</span><br><span class="line">                        &quot;2020-07-13-09-57-36-00&quot;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;, </span><br><span class="line">                &quot;model&quot;: null, </span><br><span class="line">                &quot;partitions&quot;: &#123;&#125;, </span><br><span class="line">                &quot;removable&quot;: &quot;0&quot;, </span><br><span class="line">                &quot;rotational&quot;: &quot;1&quot;, </span><br><span class="line">                &quot;sas_address&quot;: null, </span><br><span class="line">                &quot;sas_device_handle&quot;: null, </span><br><span class="line">                &quot;scheduler_mode&quot;: &quot;&quot;, </span><br><span class="line">                &quot;sectors&quot;: &quot;128696&quot;, </span><br><span class="line">                &quot;sectorsize&quot;: &quot;512&quot;, </span><br><span class="line">                &quot;size&quot;: &quot;62.84 MB&quot;, </span><br><span class="line">                &quot;support_discard&quot;: &quot;4096&quot;, </span><br><span class="line">                &quot;vendor&quot;: null, </span><br><span class="line">                &quot;virtual&quot;: 1</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;vda&quot;: &#123;</span><br><span class="line">                &quot;holders&quot;: [], </span><br><span class="line">                &quot;host&quot;: &quot;SCSI storage controller: Red Hat, Inc. Virtio block device&quot;, </span><br><span class="line">                &quot;links&quot;: &#123;</span><br><span class="line">                    &quot;ids&quot;: [], </span><br><span class="line">                    &quot;labels&quot;: [], </span><br><span class="line">                    &quot;masters&quot;: [], </span><br><span class="line">                    &quot;uuids&quot;: []</span><br><span class="line">                &#125;, </span><br><span class="line">                &quot;model&quot;: null, </span><br><span class="line">                &quot;partitions&quot;: &#123;</span><br><span class="line">                    &quot;vda1&quot;: &#123;</span><br><span class="line">                        &quot;holders&quot;: [], </span><br><span class="line">                        &quot;links&quot;: &#123;</span><br><span class="line">                            &quot;ids&quot;: [], </span><br><span class="line">                            &quot;labels&quot;: [], </span><br><span class="line">                            &quot;masters&quot;: [], </span><br><span class="line">                            &quot;uuids&quot;: [</span><br><span class="line">                                &quot;1114fe9e-2309-4580-b183-d778e6d97397&quot;</span><br><span class="line">                            ]</span><br><span class="line">                        &#125;, </span><br><span class="line">                        &quot;sectors&quot;: &quot;838847992&quot;, </span><br><span class="line">                        &quot;sectorsize&quot;: 512, </span><br><span class="line">                        &quot;size&quot;: &quot;399.99 GB&quot;, </span><br><span class="line">                        &quot;start&quot;: &quot;2048&quot;, </span><br><span class="line">                        &quot;uuid&quot;: &quot;1114fe9e-2309-4580-b183-d778e6d97397&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, </span><br><span class="line">                &quot;removable&quot;: &quot;0&quot;, </span><br><span class="line">                &quot;rotational&quot;: &quot;1&quot;, </span><br><span class="line">                &quot;sas_address&quot;: null, </span><br><span class="line">                &quot;sas_device_handle&quot;: null, </span><br><span class="line">                &quot;scheduler_mode&quot;: &quot;mq-deadline&quot;, </span><br><span class="line">                &quot;sectors&quot;: &quot;838860800&quot;, </span><br><span class="line">                &quot;sectorsize&quot;: &quot;512&quot;, </span><br><span class="line">                &quot;size&quot;: &quot;400.00 GB&quot;, </span><br><span class="line">                &quot;support_discard&quot;: &quot;0&quot;, </span><br><span class="line">                &quot;vendor&quot;: &quot;0x1af4&quot;, </span><br><span class="line">                &quot;virtual&quot;: 1</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_distribution&quot;: &quot;CentOS&quot;, </span><br><span class="line">        &quot;ansible_distribution_file_parsed&quot;: true, </span><br><span class="line">        &quot;ansible_distribution_file_path&quot;: &quot;/etc/redhat-release&quot;, </span><br><span class="line">        &quot;ansible_distribution_file_variety&quot;: &quot;RedHat&quot;, </span><br><span class="line">        &quot;ansible_distribution_major_version&quot;: &quot;7&quot;, </span><br><span class="line">        &quot;ansible_distribution_release&quot;: &quot;Core&quot;, </span><br><span class="line">        &quot;ansible_distribution_version&quot;: &quot;7.8&quot;, </span><br><span class="line">        &quot;ansible_dns&quot;: &#123;</span><br><span class="line">            &quot;nameservers&quot;: [</span><br><span class="line">                &quot;100.100.2.136&quot;, </span><br><span class="line">                &quot;100.100.2.138&quot;</span><br><span class="line">            ], </span><br><span class="line">            &quot;options&quot;: &#123;</span><br><span class="line">                &quot;attempts&quot;: &quot;3&quot;, </span><br><span class="line">                &quot;rotate&quot;: true, </span><br><span class="line">                &quot;single-request-reopen&quot;: true, </span><br><span class="line">                &quot;timeout&quot;: &quot;2&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_docker0&quot;: &#123;</span><br><span class="line">            &quot;active&quot;: false, </span><br><span class="line">            &quot;device&quot;: &quot;docker0&quot;, </span><br><span class="line">            &quot;features&quot;: &#123;</span><br><span class="line">                &quot;busy_poll&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;fcoe_mtu&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;generic_receive_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;generic_segmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;highdma&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;hw_tc_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;l2_fwd_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;large_receive_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;loopback&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;netns_local&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;ntuple_filters&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;receive_hashing&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_all&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_checksumming&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_fcs&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_gro_hw&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_udp_tunnel_port_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_filter&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_stag_filter&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_stag_hw_parse&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;scatter_gather&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tcp_segmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_checksum_fcoe_crc&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_ip_generic&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_checksum_ipv4&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_ipv6&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_sctp&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksumming&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_fcoe_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_gre_csum_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_gre_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_gso_partial&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_gso_robust&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_ipip_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_lockless&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;tx_nocache_copy&quot;: &quot;off&quot;, </span><br><span class="line">                &quot;tx_scatter_gather&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_scatter_gather_fraglist&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_sctp_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_sit_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp6_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp_ecn_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp_mangleid_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_udp_tnl_csum_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_udp_tnl_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_vlan_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_vlan_stag_hw_insert&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;udp_fragmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;vlan_challenged&quot;: &quot;off [fixed]&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;hw_timestamp_filters&quot;: [], </span><br><span class="line">            &quot;id&quot;: &quot;8000.0242e441b693&quot;, </span><br><span class="line">            &quot;interfaces&quot;: [], </span><br><span class="line">            &quot;ipv4&quot;: &#123;</span><br><span class="line">                &quot;address&quot;: &quot;172.17.0.1&quot;, </span><br><span class="line">                &quot;broadcast&quot;: &quot;172.17.255.255&quot;, </span><br><span class="line">                &quot;netmask&quot;: &quot;255.255.0.0&quot;, </span><br><span class="line">                &quot;network&quot;: &quot;172.17.0.0&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;macaddress&quot;: &quot;02:42:e4:41:b6:93&quot;, </span><br><span class="line">            &quot;mtu&quot;: 1500, </span><br><span class="line">            &quot;promisc&quot;: false, </span><br><span class="line">            &quot;stp&quot;: false, </span><br><span class="line">            &quot;timestamping&quot;: [</span><br><span class="line">                &quot;rx_software&quot;, </span><br><span class="line">                &quot;software&quot;</span><br><span class="line">            ], </span><br><span class="line">            &quot;type&quot;: &quot;bridge&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_domain&quot;: &quot;&quot;, </span><br><span class="line">        &quot;ansible_effective_group_id&quot;: 1000, </span><br><span class="line">        &quot;ansible_effective_user_id&quot;: 1000, </span><br><span class="line">        &quot;ansible_env&quot;: &#123;</span><br><span class="line">            &quot;HISTCONTROL&quot;: &quot;erasedups&quot;, </span><br><span class="line">            &quot;HISTFILESIZE&quot;: &quot;30000&quot;, </span><br><span class="line">            &quot;HISTIGNORE&quot;: &quot;pwd:ls:cd:ll:&quot;, </span><br><span class="line">            &quot;HISTSIZE&quot;: &quot;30000&quot;, </span><br><span class="line">            &quot;HISTTIMEFORMAT&quot;: &quot;%d/%m/%y %T &quot;, </span><br><span class="line">            &quot;HOME&quot;: &quot;/home/admin&quot;, </span><br><span class="line">            &quot;JAVA_HOME&quot;: &quot;/opt/taobao/java&quot;, </span><br><span class="line">            &quot;LANG&quot;: &quot;C&quot;, </span><br><span class="line">            &quot;LC_ADDRESS&quot;: &quot;zh_CN.UTF-8&quot;, </span><br><span class="line">            &quot;LC_ALL&quot;: &quot;C&quot;, </span><br><span class="line">            &quot;LC_IDENTIFICATION&quot;: &quot;zh_CN.UTF-8&quot;, </span><br><span class="line">            &quot;LC_MEASUREMENT&quot;: &quot;zh_CN.UTF-8&quot;, </span><br><span class="line">            &quot;LC_MONETARY&quot;: &quot;zh_CN.UTF-8&quot;, </span><br><span class="line">            &quot;LC_NAME&quot;: &quot;zh_CN.UTF-8&quot;, </span><br><span class="line">            &quot;LC_NUMERIC&quot;: &quot;C&quot;, </span><br><span class="line">            &quot;LC_PAPER&quot;: &quot;zh_CN.UTF-8&quot;, </span><br><span class="line">            &quot;LC_TELEPHONE&quot;: &quot;zh_CN.UTF-8&quot;, </span><br><span class="line">            &quot;LC_TIME&quot;: &quot;zh_CN.UTF-8&quot;, </span><br><span class="line">            &quot;LESSOPEN&quot;: &quot;||/usr/bin/lesspipe.sh %s&quot;, </span><br><span class="line">            &quot;LOGNAME&quot;: &quot;admin&quot;, </span><br><span class="line">            &quot;MAIL&quot;: &quot;/var/mail/admin&quot;, </span><br><span class="line">            &quot;PATH&quot;: &quot;/usr/local/bin:/usr/bin:/opt/taobao/java8/bin:/home/admin/tools&quot;, </span><br><span class="line">            &quot;PROMPT_COMMAND&quot;: &quot;history -a&quot;, </span><br><span class="line">            &quot;PS4&quot;: &quot;+($&#123;BASH_SOURCE&#125;:$&#123;LINENO&#125;): $&#123;FUNCNAME[0]:+$&#123;FUNCNAME[0]&#125;(): &#125;&quot;, </span><br><span class="line">            &quot;PWD&quot;: &quot;/home/admin&quot;, </span><br><span class="line">            &quot;SHELL&quot;: &quot;/bin/bash&quot;, </span><br><span class="line">            &quot;SHLVL&quot;: &quot;2&quot;, </span><br><span class="line">            &quot;SSH_CLIENT&quot;: &quot;192.168.1.79 51412 22&quot;, </span><br><span class="line">            &quot;SSH_CONNECTION&quot;: &quot;192.168.1.79 51412 192.168.1.91 22&quot;, </span><br><span class="line">            &quot;USER&quot;: &quot;admin&quot;, </span><br><span class="line">            &quot;XDG_RUNTIME_DIR&quot;: &quot;/run/user/1000&quot;, </span><br><span class="line">            &quot;XDG_SESSION_ID&quot;: &quot;40120&quot;, </span><br><span class="line">            &quot;_&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_eth0&quot;: &#123;</span><br><span class="line">            &quot;active&quot;: true, </span><br><span class="line">            &quot;device&quot;: &quot;eth0&quot;, </span><br><span class="line">            &quot;features&quot;: &#123;</span><br><span class="line">                &quot;busy_poll&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;fcoe_mtu&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;generic_receive_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;generic_segmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;highdma&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;hw_tc_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;l2_fwd_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;large_receive_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;loopback&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;netns_local&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;ntuple_filters&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;receive_hashing&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_all&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_checksumming&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;rx_fcs&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_gro_hw&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_udp_tunnel_port_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_filter&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_stag_filter&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_stag_hw_parse&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;scatter_gather&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tcp_segmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_checksum_fcoe_crc&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_ip_generic&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_checksum_ipv4&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_ipv6&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_sctp&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksumming&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_fcoe_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gre_csum_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gre_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gso_partial&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gso_robust&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_ipip_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_lockless&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_nocache_copy&quot;: &quot;off&quot;, </span><br><span class="line">                &quot;tx_scatter_gather&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_scatter_gather_fraglist&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_sctp_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_sit_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_tcp6_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp_ecn_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp_mangleid_segmentation&quot;: &quot;off&quot;, </span><br><span class="line">                &quot;tx_tcp_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_udp_tnl_csum_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_udp_tnl_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_vlan_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_vlan_stag_hw_insert&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;udp_fragmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;vlan_challenged&quot;: &quot;off [fixed]&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;hw_timestamp_filters&quot;: [], </span><br><span class="line">            &quot;ipv4&quot;: &#123;</span><br><span class="line">                &quot;address&quot;: &quot;192.168.0.91&quot;, </span><br><span class="line">                &quot;broadcast&quot;: &quot;192.168.0.255&quot;, </span><br><span class="line">                &quot;netmask&quot;: &quot;255.255.255.0&quot;, </span><br><span class="line">                &quot;network&quot;: &quot;192.168.0.0&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;macaddress&quot;: &quot;00:16:3e:30:d9:a4&quot;, </span><br><span class="line">            &quot;module&quot;: &quot;virtio_net&quot;, </span><br><span class="line">            &quot;mtu&quot;: 1500, </span><br><span class="line">            &quot;pciid&quot;: &quot;virtio2&quot;, </span><br><span class="line">            &quot;promisc&quot;: false, </span><br><span class="line">            &quot;timestamping&quot;: [</span><br><span class="line">                &quot;rx_software&quot;, </span><br><span class="line">                &quot;software&quot;</span><br><span class="line">            ], </span><br><span class="line">            &quot;type&quot;: &quot;ether&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_eth1&quot;: &#123;</span><br><span class="line">            &quot;active&quot;: true, </span><br><span class="line">            &quot;device&quot;: &quot;eth1&quot;, </span><br><span class="line">            &quot;features&quot;: &#123;</span><br><span class="line">                &quot;busy_poll&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;fcoe_mtu&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;generic_receive_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;generic_segmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;highdma&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;hw_tc_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;l2_fwd_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;large_receive_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;loopback&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;netns_local&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;ntuple_filters&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;receive_hashing&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_all&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_checksumming&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;rx_fcs&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_gro_hw&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_udp_tunnel_port_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_filter&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_stag_filter&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_stag_hw_parse&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;scatter_gather&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tcp_segmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_checksum_fcoe_crc&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_ip_generic&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_checksum_ipv4&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_ipv6&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_sctp&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksumming&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_fcoe_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gre_csum_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gre_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gso_partial&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gso_robust&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_ipip_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_lockless&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_nocache_copy&quot;: &quot;off&quot;, </span><br><span class="line">                &quot;tx_scatter_gather&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_scatter_gather_fraglist&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_sctp_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_sit_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_tcp6_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp_ecn_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp_mangleid_segmentation&quot;: &quot;off&quot;, </span><br><span class="line">                &quot;tx_tcp_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_udp_tnl_csum_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_udp_tnl_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_vlan_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_vlan_stag_hw_insert&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;udp_fragmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;vlan_challenged&quot;: &quot;off [fixed]&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;hw_timestamp_filters&quot;: [], </span><br><span class="line">            &quot;ipv4&quot;: &#123;</span><br><span class="line">                &quot;address&quot;: &quot;192.168.1.91&quot;, </span><br><span class="line">                &quot;broadcast&quot;: &quot;192.168.1.255&quot;, </span><br><span class="line">                &quot;netmask&quot;: &quot;255.255.255.0&quot;, </span><br><span class="line">                &quot;network&quot;: &quot;192.168.1.0&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;macaddress&quot;: &quot;00:16:3e:2c:a2:c2&quot;, </span><br><span class="line">            &quot;module&quot;: &quot;virtio_net&quot;, </span><br><span class="line">            &quot;mtu&quot;: 1500, </span><br><span class="line">            &quot;pciid&quot;: &quot;virtio4&quot;, </span><br><span class="line">            &quot;promisc&quot;: false, </span><br><span class="line">            &quot;timestamping&quot;: [</span><br><span class="line">                &quot;rx_software&quot;, </span><br><span class="line">                &quot;software&quot;</span><br><span class="line">            ], </span><br><span class="line">            &quot;type&quot;: &quot;ether&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_fibre_channel_wwn&quot;: [], </span><br><span class="line">        &quot;ansible_fips&quot;: false, </span><br><span class="line">        &quot;ansible_form_factor&quot;: &quot;Other&quot;, </span><br><span class="line">        &quot;ansible_fqdn&quot;: &quot;jtdb001&quot;, </span><br><span class="line">        &quot;ansible_hostname&quot;: &quot;jtdb001&quot;, </span><br><span class="line">        &quot;ansible_hostnqn&quot;: &quot;&quot;, </span><br><span class="line">        &quot;ansible_interfaces&quot;: [</span><br><span class="line">            &quot;lo&quot;, </span><br><span class="line">            &quot;docker0&quot;, </span><br><span class="line">            &quot;eth1&quot;, </span><br><span class="line">            &quot;eth0&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;ansible_is_chroot&quot;: false, </span><br><span class="line">        &quot;ansible_iscsi_iqn&quot;: &quot;&quot;, </span><br><span class="line">        &quot;ansible_kernel&quot;: &quot;3.10.0-957.21.3.el7.x86_64&quot;, </span><br><span class="line">        &quot;ansible_kernel_version&quot;: &quot;#1 SMP Tue Jun 18 16:35:19 UTC 2019&quot;, </span><br><span class="line">        &quot;ansible_lo&quot;: &#123;</span><br><span class="line">            &quot;active&quot;: true, </span><br><span class="line">            &quot;device&quot;: &quot;lo&quot;, </span><br><span class="line">            &quot;features&quot;: &#123;</span><br><span class="line">                &quot;busy_poll&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;fcoe_mtu&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;generic_receive_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;generic_segmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;highdma&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;hw_tc_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;l2_fwd_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;large_receive_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;loopback&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;netns_local&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;ntuple_filters&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;receive_hashing&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_all&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_checksumming&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;rx_fcs&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_gro_hw&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_udp_tunnel_port_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_filter&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_stag_filter&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;rx_vlan_stag_hw_parse&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;scatter_gather&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tcp_segmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_checksum_fcoe_crc&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_ip_generic&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_ipv4&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_ipv6&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksum_sctp&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;tx_checksumming&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_fcoe_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gre_csum_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gre_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gso_partial&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_gso_robust&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_ipip_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_lockless&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;tx_nocache_copy&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_scatter_gather&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;tx_scatter_gather_fraglist&quot;: &quot;on [fixed]&quot;, </span><br><span class="line">                &quot;tx_sctp_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_sit_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_tcp6_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp_ecn_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp_mangleid_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_tcp_segmentation&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;tx_udp_tnl_csum_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_udp_tnl_segmentation&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_vlan_offload&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;tx_vlan_stag_hw_insert&quot;: &quot;off [fixed]&quot;, </span><br><span class="line">                &quot;udp_fragmentation_offload&quot;: &quot;on&quot;, </span><br><span class="line">                &quot;vlan_challenged&quot;: &quot;on [fixed]&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;hw_timestamp_filters&quot;: [], </span><br><span class="line">            &quot;ipv4&quot;: &#123;</span><br><span class="line">                &quot;address&quot;: &quot;127.0.0.1&quot;, </span><br><span class="line">                &quot;broadcast&quot;: &quot;host&quot;, </span><br><span class="line">                &quot;netmask&quot;: &quot;255.0.0.0&quot;, </span><br><span class="line">                &quot;network&quot;: &quot;127.0.0.0&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;mtu&quot;: 65536, </span><br><span class="line">            &quot;promisc&quot;: false, </span><br><span class="line">            &quot;timestamping&quot;: [</span><br><span class="line">                &quot;rx_software&quot;, </span><br><span class="line">                &quot;software&quot;</span><br><span class="line">            ], </span><br><span class="line">            &quot;type&quot;: &quot;loopback&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_local&quot;: &#123;&#125;, </span><br><span class="line">        &quot;ansible_lsb&quot;: &#123;&#125;, </span><br><span class="line">        &quot;ansible_machine&quot;: &quot;x86_64&quot;, </span><br><span class="line">        &quot;ansible_machine_id&quot;: &quot;20190711105006363114529432776998&quot;, </span><br><span class="line">        &quot;ansible_memfree_mb&quot;: 33368, </span><br><span class="line">        &quot;ansible_memory_mb&quot;: &#123;</span><br><span class="line">            &quot;nocache&quot;: &#123;</span><br><span class="line">                &quot;free&quot;: 41285, </span><br><span class="line">                &quot;used&quot;: 6079</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;real&quot;: &#123;</span><br><span class="line">                &quot;free&quot;: 33368, </span><br><span class="line">                &quot;total&quot;: 47364, </span><br><span class="line">                &quot;used&quot;: 13996</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;swap&quot;: &#123;</span><br><span class="line">                &quot;cached&quot;: 0, </span><br><span class="line">                &quot;free&quot;: 0, </span><br><span class="line">                &quot;total&quot;: 0, </span><br><span class="line">                &quot;used&quot;: 0</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_memtotal_mb&quot;: 47364, </span><br><span class="line">        &quot;ansible_mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;block_available&quot;: 0, </span><br><span class="line">                &quot;block_size&quot;: 2048, </span><br><span class="line">                &quot;block_total&quot;: 32174, </span><br><span class="line">                &quot;block_used&quot;: 32174, </span><br><span class="line">                &quot;device&quot;: &quot;/dev/loop2&quot;, </span><br><span class="line">                &quot;fstype&quot;: &quot;iso9660&quot;, </span><br><span class="line">                &quot;inode_available&quot;: 0, </span><br><span class="line">                &quot;inode_total&quot;: 0, </span><br><span class="line">                &quot;inode_used&quot;: 0, </span><br><span class="line">                &quot;mount&quot;: &quot;/mnt/yum&quot;, </span><br><span class="line">                &quot;options&quot;: &quot;ro,relatime&quot;, </span><br><span class="line">                &quot;size_available&quot;: 0, </span><br><span class="line">                &quot;size_total&quot;: 65892352, </span><br><span class="line">                &quot;uuid&quot;: &quot;2020-07-13-09-57-36-00&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &#123;</span><br><span class="line">                &quot;block_available&quot;: 0, </span><br><span class="line">                &quot;block_size&quot;: 2048, </span><br><span class="line">                &quot;block_total&quot;: 81981, </span><br><span class="line">                &quot;block_used&quot;: 81981, </span><br><span class="line">                &quot;device&quot;: &quot;/dev/loop0&quot;, </span><br><span class="line">                &quot;fstype&quot;: &quot;iso9660&quot;, </span><br><span class="line">                &quot;inode_available&quot;: 0, </span><br><span class="line">                &quot;inode_total&quot;: 0, </span><br><span class="line">                &quot;inode_used&quot;: 0, </span><br><span class="line">                &quot;mount&quot;: &quot;/mnt/iso&quot;, </span><br><span class="line">                &quot;options&quot;: &quot;ro,relatime&quot;, </span><br><span class="line">                &quot;size_available&quot;: 0, </span><br><span class="line">                &quot;size_total&quot;: 167897088, </span><br><span class="line">                &quot;uuid&quot;: &quot;2020-07-12-14-26-47-00&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &#123;</span><br><span class="line">                &quot;block_available&quot;: 0, </span><br><span class="line">                &quot;block_size&quot;: 2048, </span><br><span class="line">                &quot;block_total&quot;: 89793, </span><br><span class="line">                &quot;block_used&quot;: 89793, </span><br><span class="line">                &quot;device&quot;: &quot;/dev/loop1&quot;, </span><br><span class="line">                &quot;fstype&quot;: &quot;iso9660&quot;, </span><br><span class="line">                &quot;inode_available&quot;: 0, </span><br><span class="line">                &quot;inode_total&quot;: 0, </span><br><span class="line">                &quot;inode_used&quot;: 0, </span><br><span class="line">                &quot;mount&quot;: &quot;/mnt/drds&quot;, </span><br><span class="line">                &quot;options&quot;: &quot;ro,relatime&quot;, </span><br><span class="line">                &quot;size_available&quot;: 0, </span><br><span class="line">                &quot;size_total&quot;: 183896064, </span><br><span class="line">                &quot;uuid&quot;: &quot;2020-07-12-20-25-18-00&quot;</span><br><span class="line">            &#125;, </span><br><span class="line">            &#123;</span><br><span class="line">                &quot;block_available&quot;: 96685158, </span><br><span class="line">                &quot;block_size&quot;: 4096, </span><br><span class="line">                &quot;block_total&quot;: 103177963, </span><br><span class="line">                &quot;block_used&quot;: 6492805, </span><br><span class="line">                &quot;device&quot;: &quot;/dev/vda1&quot;, </span><br><span class="line">                &quot;fstype&quot;: &quot;ext4&quot;, </span><br><span class="line">                &quot;inode_available&quot;: 26110896, </span><br><span class="line">                &quot;inode_total&quot;: 26214400, </span><br><span class="line">                &quot;inode_used&quot;: 103504, </span><br><span class="line">                &quot;mount&quot;: &quot;/&quot;, </span><br><span class="line">                &quot;options&quot;: &quot;rw,relatime,data=ordered&quot;, </span><br><span class="line">                &quot;size_available&quot;: 396022407168, </span><br><span class="line">                &quot;size_total&quot;: 422616936448, </span><br><span class="line">                &quot;uuid&quot;: &quot;1114fe9e-2309-4580-b183-d778e6d97397&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ], </span><br><span class="line">        &quot;ansible_nodename&quot;: &quot;jtdb001&quot;, </span><br><span class="line">        &quot;ansible_os_family&quot;: &quot;RedHat&quot;, </span><br><span class="line">        &quot;ansible_pkg_mgr&quot;: &quot;yum&quot;, </span><br><span class="line">        &quot;ansible_proc_cmdline&quot;: &#123;</span><br><span class="line">            &quot;BOOT_IMAGE&quot;: &quot;/boot/vmlinuz-3.10.0-957.21.3.el7.x86_64&quot;, </span><br><span class="line">            &quot;LANG&quot;: &quot;en_US.UTF-8&quot;, </span><br><span class="line">            &quot;biosdevname&quot;: &quot;0&quot;, </span><br><span class="line">            &quot;console&quot;: [</span><br><span class="line">                &quot;tty0&quot;, </span><br><span class="line">                &quot;ttyS0,115200n8&quot;</span><br><span class="line">            ], </span><br><span class="line">            &quot;crashkernel&quot;: &quot;auto&quot;, </span><br><span class="line">            &quot;idle&quot;: &quot;halt&quot;, </span><br><span class="line">            &quot;net.ifnames&quot;: &quot;0&quot;, </span><br><span class="line">            &quot;noibrs&quot;: true, </span><br><span class="line">            &quot;quiet&quot;: true, </span><br><span class="line">            &quot;rhgb&quot;: true, </span><br><span class="line">            &quot;ro&quot;: true, </span><br><span class="line">            &quot;root&quot;: &quot;UUID=1114fe9e-2309-4580-b183-d778e6d97397&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_processor&quot;: [</span><br><span class="line">            &quot;0&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;1&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;2&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;3&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;4&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;5&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;6&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;7&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;8&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;9&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;10&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;, </span><br><span class="line">            &quot;11&quot;, </span><br><span class="line">            &quot;GenuineIntel&quot;, </span><br><span class="line">            &quot;Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;ansible_processor_cores&quot;: 6, </span><br><span class="line">        &quot;ansible_processor_count&quot;: 1, </span><br><span class="line">        &quot;ansible_processor_threads_per_core&quot;: 2, </span><br><span class="line">        &quot;ansible_processor_vcpus&quot;: 12, </span><br><span class="line">        &quot;ansible_product_name&quot;: &quot;Alibaba Cloud ECS&quot;, </span><br><span class="line">        &quot;ansible_product_serial&quot;: &quot;NA&quot;, </span><br><span class="line">        &quot;ansible_product_uuid&quot;: &quot;NA&quot;, </span><br><span class="line">        &quot;ansible_product_version&quot;: &quot;pc-i440fx-2.1&quot;, </span><br><span class="line">        &quot;ansible_python&quot;: &#123;</span><br><span class="line">            &quot;executable&quot;: &quot;/usr/bin/python&quot;, </span><br><span class="line">            &quot;has_sslcontext&quot;: true, </span><br><span class="line">            &quot;type&quot;: &quot;CPython&quot;, </span><br><span class="line">            &quot;version&quot;: &#123;</span><br><span class="line">                &quot;major&quot;: 2, </span><br><span class="line">                &quot;micro&quot;: 5, </span><br><span class="line">                &quot;minor&quot;: 7, </span><br><span class="line">                &quot;releaselevel&quot;: &quot;final&quot;, </span><br><span class="line">                &quot;serial&quot;: 0</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;version_info&quot;: [</span><br><span class="line">                2, </span><br><span class="line">                7, </span><br><span class="line">                5, </span><br><span class="line">                &quot;final&quot;, </span><br><span class="line">                0</span><br><span class="line">            ]</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_python_version&quot;: &quot;2.7.5&quot;, </span><br><span class="line">        &quot;ansible_real_group_id&quot;: 1000, </span><br><span class="line">        &quot;ansible_real_user_id&quot;: 1000, </span><br><span class="line">        &quot;ansible_selinux&quot;: &#123;</span><br><span class="line">            &quot;status&quot;: &quot;disabled&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_selinux_python_present&quot;: true, </span><br><span class="line">        &quot;ansible_service_mgr&quot;: &quot;systemd&quot;, </span><br><span class="line">        &quot;ansible_ssh_host_key_dsa_public&quot;: &quot;AAAAB3NzaC1kc3MAAACBAIjMSdXjIBwLTRwqzzLzJzw52IikcmHpmM65Idw9Q/CCH23SJdmmYzl9LIWFTEf2ZP4dHYibvgWtqfc6AHLFVgM1lz3wwdJJSyBD1TyFet+MPZEA1A9jw2Ke2K9C942dWATCpi3B0nk0KJDp49+V0QjUUjZmzt7I66wDmPLpW7mNAAAAFQDXmbLv48zsFHUgPiixhcKsk29ZPQAAAIAHHM+jfcL3V/X6EovQGj/2OytDN7k5hb4KRNTzBwh9JU5V44+S3r5ZViJDthKBolVT1CLX8jAivBu6d70ImYcZLa75AImOnlSp9D4xGP4TNfdAYrA7CkYpzn8ky15xjFDjkL0BjVmeEg6In+04tZOp/kIi/Ft9/ld63W4xopspwwAAAIAhBCIAMW37rknrsmv3sXmhgt+FeUQA/o8moZKcX+xI5sv27NEavQGGKOvZM4+nhCggRvjWaxC9N1DnO2g52trhGrUhNF0qwn/4iar/yknZWwRyZXzB3YtOdJXxCoJphuuGeqJRsLPb7OEIAF7c3lFJcfMUrwcjWrRtFMUM6mE+gQ==&quot;, </span><br><span class="line">        &quot;ansible_ssh_host_key_ecdsa_public&quot;: &quot;AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMffg6EX26f+10IIgg/U7+PsCUDs8Ep0MUttUyVh3+bJ7/K7ROMhuc8BTieA4PRj3MOaKMbUuZTqPTmrK/4srqg=&quot;, </span><br><span class="line">        &quot;ansible_ssh_host_key_ed25519_public&quot;: &quot;AAAAC3NzaC1lZDI1NTE5AAAAINIKYkm+FKDTvx6VgENoAnXwOJQ+xZjk3rkvUqZ/4F3i&quot;, </span><br><span class="line">        &quot;ansible_ssh_host_key_rsa_public&quot;: &quot;AAAAB3NzaC1yc2EAAAADAQABAAABAQC1xlLrDTri/jRfph6Uqx6CoY1/+uAE34rR9sR4FtE+2OMM8kUN0+N+hWLL+8r/pzM40RJOUmELYTlibfnjkYDsmYcpxD8kOxonvlYQbpvram8Hx7X8W1thYs//Zdhltmz1ijTiEatCL/yxJnwrpxN1XOtbMtALKgykbOzF+LNevFUG05MxxQR5WVjijXwK/Auf0ce/ei3NISQZLiW+d+IVYPkAQDpbUpH5W/qGDN0W8wT2OGE0bOvrPfDPRhSxeYrcS4mgS7nGvB26sFyeAimgadnxmWaxAveargYKt33jJQhVaA/23kw+/lygQcSN1QJ2mpeHb3ugay0Gv1i/Wd7P&quot;, </span><br><span class="line">        &quot;ansible_swapfree_mb&quot;: 0, </span><br><span class="line">        &quot;ansible_swaptotal_mb&quot;: 0, </span><br><span class="line">        &quot;ansible_system&quot;: &quot;Linux&quot;, </span><br><span class="line">        &quot;ansible_system_capabilities&quot;: [</span><br><span class="line">            &quot;&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;ansible_system_capabilities_enforced&quot;: &quot;True&quot;, </span><br><span class="line">        &quot;ansible_system_vendor&quot;: &quot;Alibaba Cloud&quot;, </span><br><span class="line">        &quot;ansible_uptime_seconds&quot;: 11384976, </span><br><span class="line">        &quot;ansible_user_dir&quot;: &quot;/home/admin&quot;, </span><br><span class="line">        &quot;ansible_user_gecos&quot;: &quot;&quot;, </span><br><span class="line">        &quot;ansible_user_gid&quot;: 1000, </span><br><span class="line">        &quot;ansible_user_id&quot;: &quot;admin&quot;, </span><br><span class="line">        &quot;ansible_user_shell&quot;: &quot;/bin/bash&quot;, </span><br><span class="line">        &quot;ansible_user_uid&quot;: 1000, </span><br><span class="line">        &quot;ansible_userspace_architecture&quot;: &quot;x86_64&quot;, </span><br><span class="line">        &quot;ansible_userspace_bits&quot;: &quot;64&quot;, </span><br><span class="line">        &quot;ansible_virtualization_role&quot;: &quot;guest&quot;, </span><br><span class="line">        &quot;ansible_virtualization_type&quot;: &quot;kvm&quot;, </span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;, </span><br><span class="line">        &quot;gather_subset&quot;: [</span><br><span class="line">            &quot;all&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;module_setup&quot;: true</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ansible-xargs-占位符"><a href="#ansible-xargs-占位符" class="headerlink" title="ansible + xargs 占位符"></a>ansible + xargs 占位符</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//批量执行docker exec</span><br><span class="line">ansible -i host.ini all -m shell -a &quot;docker ps -a | grep pxd-tpcc | grep dn | cut -d &apos; &apos; -f 1 | xargs  -I&#123;&#125; docker exec &#123;&#125; bash -c \&quot;myc -e &apos;shutdown&apos;\&quot;&quot;</span><br></pre></td></tr></table></figure>

<h2 id="指定ip执行playbook"><a href="#指定ip执行playbook" class="headerlink" title="指定ip执行playbook"></a>指定ip执行playbook</h2><blockquote>
<p>ansible-playbook  -i “10.168.101.179,” all test.yml</p>
</blockquote>
<p>或者：</p>
<blockquote>
<p>ansible -i phy.ini 11.167.60.150 -m shell -a ‘docker run -it -d –net&#x3D;host -e diamond_server_list&#x3D;”“ -e diamond_db0&#x3D;”“ -e diamond_db1&#x3D;”“ -e diamond_db2&#x3D;”“ -e HOST_IP&#x3D;”“ -p 8080:8080 -p 9090:9090 –name diamond  ‘ -vvv</p>
</blockquote>
<p>上面这种还能重用phy.ini中所有的变量配置</p>
<h2 id="创建用户并打通账号"><a href="#创建用户并打通账号" class="headerlink" title="创建用户并打通账号"></a>创建用户并打通账号</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$cat create_user.yml</span><br><span class="line"># create user ren with passwd test and sudo privileges.</span><br><span class="line"># ansible-playbook -i docker.ini create_user.yml</span><br><span class="line">- hosts: all</span><br><span class="line">  user: root</span><br><span class="line">  vars:</span><br><span class="line">    # created with:</span><br><span class="line">    # python -c &apos;import crypt; print crypt.crypt(&quot;password&quot;, &quot;$1$SomeSalt$&quot;)&apos;</span><br><span class="line">    password: $1$SomeSalt$OrX9ouxOCP0ZOpVG9SwnR/</span><br><span class="line"></span><br><span class="line">  tasks:</span><br><span class="line">    - name: create a new user</span><br><span class="line">      user:</span><br><span class="line">       name: &apos;&#123;&#123; user &#125;&#125;&apos;</span><br><span class="line">       password: &apos;&#123;&#123; password &#125;&#125;&apos;</span><br><span class="line">       home: /home/&#123;&#123; user &#125;&#125;</span><br><span class="line">       state: present</span><br><span class="line">       shell: /bin/bash</span><br><span class="line"></span><br><span class="line">    - name: Add user to the sudoers</span><br><span class="line">      copy:</span><br><span class="line">          dest: &quot;/etc/sudoers.d/&#123;&#123; user &#125;&#125;&quot;</span><br><span class="line">          content: &quot;&#123;&#123; user &#125;&#125;  ALL=(ALL)  NOPASSWD: ALL&quot;</span><br><span class="line"></span><br><span class="line">    - name: Deploy SSH Key</span><br><span class="line">      authorized_key: user=&#123;&#123; user &#125;&#125;</span><br><span class="line">           key=&quot;&#123;&#123; lookup(&apos;file&apos;, &apos;/root/.ssh/id_rsa.pub&apos;) &#125;&#125;&quot;</span><br><span class="line">           state=present</span><br></pre></td></tr></table></figure>

<p>然后执行： ansible-playbook -i  all.ini create_user.yml -e “user&#x3D;admin” 。</p>
<p>或者：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> ansible -i 192.168.2.101, all -m user -a &quot;name=user02 system=yes uid=503 group=root groups=root shell=/etc/nologin home=/home/user02 password=pwd@123&quot;</span><br><span class="line"> 192.168.2.101 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;comment&quot;: &quot;&quot;, </span><br><span class="line">    &quot;create_home&quot;: true, </span><br><span class="line">    &quot;group&quot;: 0, </span><br><span class="line">    &quot;groups&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;home&quot;: &quot;/home/user02&quot;, </span><br><span class="line">    &quot;name&quot;: &quot;user02&quot;, </span><br><span class="line">    &quot;password&quot;: &quot;NOT_LOGGING_PASSWORD&quot;, </span><br><span class="line">    &quot;shell&quot;: &quot;/etc/nologin&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;present&quot;, </span><br><span class="line">    &quot;system&quot;: true, </span><br><span class="line">    &quot;uid&quot;: 503</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>playbook task规范：</p>
<p><img src="https://cdn.jsdelivr.net/gh/plantegg/plantegg.github.io/images/oss/d502a11765273304abd673fb358b482a.png" alt="image.png"></p>
<p><strong>对齐的时候不能用tab和空格混合</strong></p>
<h2 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h2><p>创建如下yaml脚本 changepw.yml:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- name: user <span class="keyword">module</span> demo</span><br><span class="line">  hosts: all</span><br><span class="line">  become: <span class="literal">true</span></span><br><span class="line">  vars:</span><br><span class="line">    user: 'admin'</span><br><span class="line">    mypassword: <span class="string">"PolarDB-X"</span></span><br><span class="line">    <span class="meta">#mypassword: <span class="meta-string">"$1$SomeSalt$PB9C3LT9wCjmaMYdBWsRS1"</span></span></span><br><span class="line"></span><br><span class="line">  tasks:</span><br><span class="line">    - name: change password</span><br><span class="line">      ansible.builtin.user:</span><br><span class="line">        name: <span class="string">"&#123;&#123; user &#125;&#125;"</span></span><br><span class="line">        state: present</span><br><span class="line">        password: <span class="string">"&#123;&#123; mypassword | password_hash('sha512') &#125;&#125;"</span></span><br></pre></td></tr></table></figure>

<p>使用方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook -i 1.2.3.4, changepw.yml -e &quot;user=root&quot; -e &quot;mypassword=123&quot;</span><br></pre></td></tr></table></figure>

<p>将 root 账号的密码改成123</p>
<p>或者：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible -i 1.2.3.4, all -e &quot;newpassword=1234&quot; -m user -a &quot;name=admin update_password=always password=&#123;&#123; newpassword|password_hash(&apos;sha512&apos;) &#125;&#125;&quot;</span><br></pre></td></tr></table></figure>

<h3 id="创建用户以及密码"><a href="#创建用户以及密码" class="headerlink" title="创建用户以及密码"></a>创建用户以及密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible -i 1.2.3.4, all  -e &quot;newpassword=1234&quot; -m user -a &quot;name=ren state=present shell=/bin/sh update_password=always password=&#123;&#123; newpassword|password_hash(&apos;sha512&apos;) &#125;&#125;&quot;</span><br></pre></td></tr></table></figure>

<h2 id="部署docker-daemon的playbook"><a href="#部署docker-daemon的playbook" class="headerlink" title="部署docker daemon的playbook"></a>部署docker daemon的playbook</h2><p>执行 ansible-playbook site.yml -v  -i test.ini -u admin -e “project&#x3D;docker” -p</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">$cat roles/docker/tasks/main.yml </span><br><span class="line"># filename: main.yml</span><br><span class="line">---</span><br><span class="line">#&quot;****************************************************************************&quot;&quot;</span><br><span class="line">- name: copy docker execute file to remote</span><br><span class="line">  copy: src=docker/ dest=/usr/bin/ mode=0755 force=yes</span><br><span class="line">  tags: copytar</span><br><span class="line"></span><br><span class="line">- name: create storage dir</span><br><span class="line">  file: path=&#123;&#123; storage_dir &#125;&#125; state=directory</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  tags: docker</span><br><span class="line"></span><br><span class="line">- name: create the dir</span><br><span class="line">  file: path=/etc/systemd/system/ state=directory</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  tags: docker</span><br><span class="line"></span><br><span class="line">- name: template docker.service to server</span><br><span class="line">  template: src=docker.service dest=/etc/systemd/system/docker.service</span><br><span class="line">  tags: docker</span><br><span class="line"></span><br><span class="line">- name: template docker.socket to server</span><br><span class="line">  template: src=docker.socket dest=/usr/lib/systemd/system/docker.socket</span><br><span class="line">  tags: docker</span><br><span class="line"></span><br><span class="line">- name: create /etc/docker dir to server</span><br><span class="line">  file: path=/etc/docker state=directory</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  tags: docker</span><br><span class="line"></span><br><span class="line">- name: copy daemon.json to server</span><br><span class="line">  template: src=&#123;&#123; inventory_hostname &#125;&#125;/daemon.json dest=/etc/docker/daemon.json</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  tags: docker</span><br><span class="line"></span><br><span class="line">- name: copy the load ovs modules to server</span><br><span class="line">  copy: src=openvswitch.modules dest=/etc/sysconfig/modules/openvswitch.modules mode=0755  force=yes</span><br><span class="line">  tags: docker</span><br><span class="line"></span><br><span class="line">- name: kill docker daemon</span><br><span class="line">  shell: &quot;kill -9 $(cat /var/run/docker.pid)&quot;</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  tags: test</span><br><span class="line"></span><br><span class="line">- name: reload systemctl daemon-reload</span><br><span class="line">  shell: &quot;systemctl daemon-reload&quot;</span><br><span class="line">  tags: docker</span><br><span class="line"></span><br><span class="line">- name: enabled the docker service</span><br><span class="line">  shell: &quot;systemctl enable docker.service&quot;</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  tags: docker</span><br><span class="line"></span><br><span class="line">- name: start docker service</span><br><span class="line">  shell: &quot;systemctl start docker.service&quot;</span><br><span class="line"></span><br><span class="line">- name: remove all containers</span><br><span class="line">  shell: sudo docker ps -a | awk &apos;&#123;print $1&#125;&apos; | xargs sudo docker rm -f -v</span><br><span class="line">  ignore_errors: true</span><br><span class="line"></span><br><span class="line">- name: template /etc/hosts to server</span><br><span class="line">  template: src=hosts dest=/etc/hosts owner=root group=root mode=0644 force=yes</span><br><span class="line">  tags: restorehosts</span><br><span class="line"></span><br><span class="line">- name: mkdir /tmp/etc/</span><br><span class="line">  shell: &quot;mkdir /tmp/etc/ &quot;</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  tags: hosts</span><br><span class="line"></span><br><span class="line">- name: copy remote /etc/hosts to /tmp</span><br><span class="line">  shell: &quot;cp /etc/hosts /tmp/etc/ &quot;</span><br><span class="line">  tags: hosts</span><br><span class="line"></span><br><span class="line">- name: copy /etc/hosts to server</span><br><span class="line">  template: src=etc.host dest=/tmp/etc/ owner=&#123;&#123; remote_user &#125;&#125; group=&#123;&#123; remote_user &#125;&#125; mode=0700 force=yes</span><br><span class="line">  tags: hosts</span><br><span class="line"></span><br><span class="line">- name: merge /etc/hosts</span><br><span class="line">  assemble: src=/tmp/etc dest=/etc/hosts owner=root group=root mode=0644 force=yes</span><br><span class="line">  tags: hosts</span><br><span class="line"></span><br><span class="line">- name: copy docker_rc.sh to server</span><br><span class="line">  template: src=docker_rc.sh dest=&#123;&#123; docker_rc_dir &#125;&#125;/docker_rc.sh owner=root group=root mode=0755 force=yes</span><br><span class="line">  when: use_vxlan!=&quot;true&quot;</span><br><span class="line">  tags: docker_rc</span><br><span class="line"></span><br><span class="line">- name: copy docker_rc.sh to server</span><br><span class="line">  template: src=docker_rc_vm.sh dest=&#123;&#123; docker_rc_dir &#125;&#125;/docker_rc.sh owner=root group=root mode=0755 force=yes</span><br><span class="line">  when: use_vxlan==&quot;true&quot;</span><br><span class="line">  tags: docker_rc</span><br><span class="line"></span><br><span class="line">- name: clean docker_rc in rc.local</span><br><span class="line">  command: su - root -c &quot; sed -i &apos;/docker_rc.sh/d&apos; /etc/rc.d/rc.local &quot;</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  sudo: yes</span><br><span class="line">  tags: docker_rc</span><br><span class="line"></span><br><span class="line">- name: start the docker when the system reboot</span><br><span class="line">  command: su - root -c &quot; echo &apos;su - root -c \&quot;&#123;&#123; docker_rc_dir &#125;&#125;/docker_rc.sh\&quot; &apos; &gt;&gt; /etc/rc.d/rc.local &quot;</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  sudo: yes</span><br><span class="line">  tags: docker_rc</span><br><span class="line"></span><br><span class="line">- name: chown the /etc/rc.d/rc.local</span><br><span class="line">  shell: &quot;chmod +x /etc/rc.d/rc.local &quot;</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  sudo: yes</span><br><span class="line">  tags: docker_rc</span><br><span class="line"></span><br><span class="line">- name: clean previous space occupier</span><br><span class="line">  file: path=&#123;&#123; storage_dir &#125;&#125;/ark.disk&#123;&#123; item &#125;&#125;.tmp state=absent</span><br><span class="line">  with_items:</span><br><span class="line">    - 1</span><br><span class="line">    - 2</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  tags: docker</span><br><span class="line"></span><br><span class="line">- name: Occupy space for docker</span><br><span class="line">  shell: &quot;dd if=/dev/zero of=&#123;&#123; storage_dir &#125;&#125;/ark.disk&#123;&#123; item &#125;&#125;.tmp bs=1M count=1024&quot;</span><br><span class="line">  sudo: yes</span><br><span class="line">  with_items:</span><br><span class="line">    - 1</span><br><span class="line">    - 2</span><br><span class="line">  tags: docker</span><br></pre></td></tr></table></figure>

<h2 id="部署zk"><a href="#部署zk" class="headerlink" title="部署zk"></a>部署zk</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">$cat roles/zookeeper/tasks/main.yml</span><br><span class="line"># filename: main.yml</span><br><span class="line">---</span><br><span class="line">#&quot;****************************************************************************&quot;&quot;</span><br><span class="line">- name: extract zookeeper tgz</span><br><span class="line">  unarchive: src=&#123;&#123; packages_dir &#125;&#125;/lib/&#123;&#123; zk_package_name &#125;&#125; dest=/opt</span><br><span class="line">  sudo: yes</span><br><span class="line"></span><br><span class="line">- name: create zk data and log dir</span><br><span class="line">  file: path=&#123;&#123; zk_data_dir &#125;&#125; state=directory mode=0755</span><br><span class="line">  with_items:</span><br><span class="line">    - &quot;&#123;&#123; zk_data_dir &#125;&#125;&quot;</span><br><span class="line">    - &quot;&#123;&#123; zk_logs_dir &#125;&#125;&quot;</span><br><span class="line"></span><br><span class="line">- name: set the myid</span><br><span class="line">  template: src=myid dest=&#123;&#123; zk_myid_file &#125;&#125;  mode=0644</span><br><span class="line"></span><br><span class="line">- name: template zoo.cfg</span><br><span class="line">  template: src=zoo.cfg dest=&#123;&#123; zk_install_dir &#125;&#125;/conf/ mode=0644</span><br><span class="line"></span><br><span class="line">- name: copy log4j to remote</span><br><span class="line">  template: src=log4j.properties dest=&#123;&#123; zk_install_dir &#125;&#125;/conf/log4j.properties</span><br><span class="line"></span><br><span class="line">- name: determine zk process</span><br><span class="line">  command: su - root -c &quot;ps aux | grep java | grep -v grep | grep &#123;&#123; zk_install_dir &#125;&#125;&quot;</span><br><span class="line">  register: result</span><br><span class="line">  ignore_errors: true</span><br><span class="line"></span><br><span class="line">- name: stop zk server</span><br><span class="line">  command: su - root -c &quot;sh &#123;&#123; zk_install_dir &#125;&#125;/bin/zkServer.sh  stop&quot;</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  when: &quot;result.rc == 0&quot;</span><br><span class="line"></span><br><span class="line">- name: start zk server</span><br><span class="line">  command: su - root -c &quot;sh &#123;&#123; zk_install_dir &#125;&#125;/bin/zkServer.sh start&quot;</span><br><span class="line"></span><br><span class="line">- name: get process info</span><br><span class="line">  command: su - root -c &quot;ps aux | grep java | grep -v grep | grep &#123;&#123; zk_install_dir &#125;&#125;&quot;</span><br><span class="line">  register: result</span><br><span class="line"></span><br><span class="line">- name: clean zk service when the system reboot</span><br><span class="line">  command: su - root -c &quot; sed -i &apos;/&#123;&#123; zk_dir_name &#125;&#125;/d&apos; /etc/rc.d/rc.local &quot;</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  sudo: yes</span><br><span class="line"></span><br><span class="line">- name: start the zk service when the system reboot</span><br><span class="line">  command: su - root -c &quot; echo &apos;su - root -c \&quot;&#123;&#123; zk_install_dir &#125;&#125;/bin/zkServer.sh start\&quot; &apos; &gt;&gt; /etc/rc.d/rc.local &quot;</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  sudo: yes</span><br><span class="line"></span><br><span class="line">- name: start the zk service when the system reboot</span><br><span class="line">  shell: &quot;chmod +x /etc/rc.d/rc.local &quot;</span><br><span class="line">  ignore_errors: true</span><br><span class="line">  sudo: yes</span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.mydailytutorials.com/how-to-copy-files-and-directories-in-ansible-using-copy-and-fetch-modules/" target="_blank" rel="noopener">How to Copy Files and Directories in Ansible Using Copy and Fetch Modules</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Linux/" rel="tag"># Linux</a>
          
            <a href="/tags/Ansible/" rel="tag"># Ansible</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/03/24/ansible 常见问题/" rel="next" title="ansible 常见问题">
                <i class="fa fa-chevron-left"></i> ansible 常见问题
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/08/24/Linux tc qdisc的使用案例/" rel="prev" title="Linux tc qdisc的使用案例">
                Linux tc qdisc的使用案例 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="twitter @plantegg">
          <p class="site-author-name" itemprop="name">twitter @plantegg</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">187</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">276</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ansible-命令使用手册"><span class="nav-number">1.</span> <span class="nav-text">ansible 命令使用手册</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是命令通道？"><span class="nav-number">1.1.</span> <span class="nav-text">什么是命令通道？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用场景"><span class="nav-number">1.2.</span> <span class="nav-text">使用场景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#开始准备"><span class="nav-number">1.3.</span> <span class="nav-text">开始准备</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#编写一个-hosts-ini-配置文件，内容如下"><span class="nav-number">1.3.1.</span> <span class="nav-text">编写一个 hosts.ini 配置文件，内容如下:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#运行命令行"><span class="nav-number">1.4.</span> <span class="nav-text">运行命令行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#查看-hosts-ini-里面所有服务器的-uptime"><span class="nav-number">1.4.1.</span> <span class="nav-text">查看 hosts.ini 里面所有服务器的 uptime</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ansible-i-ccb-test-ini-192-168-2-10-m-shell-a-‘hostname-‘"><span class="nav-number">2.</span> <span class="nav-text">ansible -i ccb_test.ini 192.168.2.10* -m shell -a ‘hostname ‘</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ansible-i-ccb-test-ini-192-168-2-101-m-hostname-a-“-name-x3D-az2-alisql-101-“"><span class="nav-number">3.</span> <span class="nav-text">ansible -i ccb_test.ini 192.168.2.101 -m hostname -a “ name=az2-alisql-101 “</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ansible-i-ccb-test-ini-192-168-2-101-m-service-a-“-name-x3D-docker-enabled-x3D-yes-state-x3D-restarted-“"><span class="nav-number">4.</span> <span class="nav-text">ansible -i ccb_test.ini 192.168.2.101 -m service -a “ name=docker enabled=yes state=restarted “</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#copy个人笔记本的公钥到服务器上，以后从笔记本登录服务器不再需要输入密码"><span class="nav-number">4.0.1.</span> <span class="nav-text">copy个人笔记本的公钥到服务器上，以后从笔记本登录服务器不再需要输入密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Copying-files-between-different-folders-on-the-same-remote-machine"><span class="nav-number">4.0.2.</span> <span class="nav-text">Copying files between different folders on the same remote machine</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#效率更高的-copy：synchronize"><span class="nav-number">4.0.3.</span> <span class="nav-text">效率更高的 copy：synchronize</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#find-file"><span class="nav-number">4.0.4.</span> <span class="nav-text">find_file</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不使用-hosts-ini文件，从命令行中传入目标机的-ip-列表"><span class="nav-number">4.0.5.</span> <span class="nav-text">不使用 hosts.ini文件，从命令行中传入目标机的 ip 列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用root-sudo权限来执行命令"><span class="nav-number">4.0.6.</span> <span class="nav-text">使用root sudo权限来执行命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#给admin授权登录server不需要输入密码（也不知道admin的密码）"><span class="nav-number">4.0.7.</span> <span class="nav-text">给admin授权登录server不需要输入密码（也不知道admin的密码）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetch-将远程服务器上的public-key-读取到本地"><span class="nav-number">4.0.8.</span> <span class="nav-text">fetch:将远程服务器上的public key 读取到本地</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#setup-获取机器配置、参数信息"><span class="nav-number">4.0.9.</span> <span class="nav-text">setup:获取机器配置、参数信息</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ansible-xargs-占位符"><span class="nav-number">4.1.</span> <span class="nav-text">ansible + xargs 占位符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#指定ip执行playbook"><span class="nav-number">4.2.</span> <span class="nav-text">指定ip执行playbook</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建用户并打通账号"><span class="nav-number">4.3.</span> <span class="nav-text">创建用户并打通账号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改密码"><span class="nav-number">4.4.</span> <span class="nav-text">修改密码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建用户以及密码"><span class="nav-number">4.4.1.</span> <span class="nav-text">创建用户以及密码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#部署docker-daemon的playbook"><span class="nav-number">4.5.</span> <span class="nav-text">部署docker daemon的playbook</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#部署zk"><span class="nav-number">4.6.</span> <span class="nav-text">部署zk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">4.7.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">twitter @plantegg</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv_footer"></span>次
</span>
<span id="busuanzi_container_site_uv">
  本站访客数<span id="busuanzi_value_site_uv_footer"></span>人次
</span>


        
<div class="busuanzi-count">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  

</body>
</html>
