<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"plantegg.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="MySQL PreparedStatement æ€§èƒ½é—®é¢˜é‡ç°é—®é¢˜æè¿°åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‘ç°ï¼Œå½“ä½¿ç”¨ useServerPrepStmts&#x3D;true å‚æ•°æ—¶ï¼ŒåŒ…å«å¤§é‡å‚æ•°çš„ PreparedStatement æŸ¥è¯¢æ€§èƒ½æå·®ã€‚é€šè¿‡ç³»ç»Ÿæµ‹è¯•å‘ç°ï¼ŒSQL æ ¼å¼å’Œé•¿åº¦å¯¹æ€§èƒ½æœ‰å·¨å¤§å½±å“ã€‚ åªéœ€è¦ä¸€ä¸ªç©ºè¡¨å°±èƒ½ç¨³å®šé‡ç°è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç»™å®˜æ–¹æäº¤ bug äº† ç¯å¢ƒä¿¡æ¯ MySQLç‰ˆæœ¬: 5.7.29 JDBCé©±åŠ¨: mys">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL PreparedStatement æ€§èƒ½é—®é¢˜é‡ç°">
<meta property="og:url" content="https://plantegg.github.io/2025/11/05/MySQL_PreparedStatement_Performance_Issue_Reproduction/index.html">
<meta property="og:site_name" content="plantegg">
<meta property="og:description" content="MySQL PreparedStatement æ€§èƒ½é—®é¢˜é‡ç°é—®é¢˜æè¿°åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‘ç°ï¼Œå½“ä½¿ç”¨ useServerPrepStmts&#x3D;true å‚æ•°æ—¶ï¼ŒåŒ…å«å¤§é‡å‚æ•°çš„ PreparedStatement æŸ¥è¯¢æ€§èƒ½æå·®ã€‚é€šè¿‡ç³»ç»Ÿæµ‹è¯•å‘ç°ï¼ŒSQL æ ¼å¼å’Œé•¿åº¦å¯¹æ€§èƒ½æœ‰å·¨å¤§å½±å“ã€‚ åªéœ€è¦ä¸€ä¸ªç©ºè¡¨å°±èƒ½ç¨³å®šé‡ç°è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç»™å®˜æ–¹æäº¤ bug äº† ç¯å¢ƒä¿¡æ¯ MySQLç‰ˆæœ¬: 5.7.29 JDBCé©±åŠ¨: mys">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-11-05T09:30:03.000Z">
<meta property="article:modified_time" content="2025-11-29T07:45:36.071Z">
<meta property="article:author" content="twitter @plantegg">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="PreparedStatement">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://plantegg.github.io/2025/11/05/MySQL_PreparedStatement_Performance_Issue_Reproduction/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://plantegg.github.io/2025/11/05/MySQL_PreparedStatement_Performance_Issue_Reproduction/","path":"2025/11/05/MySQL_PreparedStatement_Performance_Issue_Reproduction/","title":"MySQL PreparedStatement æ€§èƒ½é—®é¢˜é‡ç°"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MySQL PreparedStatement æ€§èƒ½é—®é¢˜é‡ç° | plantegg</title>
  








  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">plantegg</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">java tcp mysql performance network docker Linux</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL-PreparedStatement-%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98%E9%87%8D%E7%8E%B0"><span class="nav-number">1.</span> <span class="nav-text">MySQL PreparedStatement æ€§èƒ½é—®é¢˜é‡ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0"><span class="nav-number">1.1.</span> <span class="nav-text">é—®é¢˜æè¿°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E4%BF%A1%E6%81%AF"><span class="nav-number">1.2.</span> <span class="nav-text">ç¯å¢ƒä¿¡æ¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%8F%91%E7%8E%B0"><span class="nav-number">1.3.</span> <span class="nav-text">æ ¸å¿ƒå‘ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%94%A5-SQL-%E6%A0%BC%E5%BC%8F%E5%AF%B9%E6%80%A7%E8%83%BD%E7%9A%84%E5%B7%A8%E5%A4%A7%E5%BD%B1%E5%93%8D"><span class="nav-number">1.3.1.</span> <span class="nav-text">ğŸ”¥ SQL æ ¼å¼å¯¹æ€§èƒ½çš„å·¨å¤§å½±å“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8D%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.4.</span> <span class="nav-text">é‡ç°æ­¥éª¤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="nav-number">1.4.1.</span> <span class="nav-text">1. ç¯å¢ƒå‡†å¤‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95"><span class="nav-number">1.4.2.</span> <span class="nav-text">2. è¿è¡Œæµ‹è¯•</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%84%9A%E6%9C%AC%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-Maven"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">ä½¿ç”¨ Maven</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="nav-number">1.4.3.</span> <span class="nav-text">3. å‚æ•°è¯´æ˜</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C"><span class="nav-number">1.5.</span> <span class="nav-text">è¯¦ç»†æµ‹è¯•ç»“æœ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95-1-%E7%B4%A7%E5%87%91%E6%A0%BC%E5%BC%8F-spaces-0-%E2%AD%90-%E6%8E%A8%E8%8D%90"><span class="nav-number">1.5.1.</span> <span class="nav-text">æµ‹è¯• 1: ç´§å‡‘æ ¼å¼ (spaces&#x3D;0) â­ æ¨è</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95-2-%E5%B8%A6%E6%8D%A2%E8%A1%8C%E6%A0%BC%E5%BC%8F-%E6%97%A7%E7%89%88%E6%9C%AC"><span class="nav-number">1.5.2.</span> <span class="nav-text">æµ‹è¯• 2: å¸¦æ¢è¡Œæ ¼å¼ (æ—§ç‰ˆæœ¬)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95-3-%E5%B8%A6%E7%A9%BA%E6%A0%BC%E6%A0%BC%E5%BC%8F-spaces-128"><span class="nav-number">1.5.3.</span> <span class="nav-text">æµ‹è¯• 3: å¸¦ç©ºæ ¼æ ¼å¼ (spaces&#x3D;128)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95-4-%E5%B8%A6%E6%8D%A2%E8%A1%8C-%E5%A4%A7%E9%87%8F%E7%A9%BA%E6%A0%BC-%E6%9E%81%E7%AB%AF%E6%83%85%E5%86%B5"><span class="nav-number">1.5.4.</span> <span class="nav-text">æµ‹è¯• 4: å¸¦æ¢è¡Œ+å¤§é‡ç©ºæ ¼ (æç«¯æƒ…å†µ)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="nav-number">1.6.</span> <span class="nav-text">æ€§èƒ½åˆ†æ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-SQL-%E9%95%BF%E5%BA%A6%E4%B8%8E%E6%80%A7%E8%83%BD%E7%9A%84%E7%BA%BF%E6%80%A7%E5%85%B3%E7%B3%BB"><span class="nav-number">1.6.1.</span> <span class="nav-text">1. SQL é•¿åº¦ä¸æ€§èƒ½çš„çº¿æ€§å…³ç³»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%A2%84%E7%BC%96%E8%AF%91%E7%9A%84%E7%A8%B3%E5%AE%9A%E6%80%A7"><span class="nav-number">1.6.2.</span> <span class="nav-text">2. å®¢æˆ·ç«¯é¢„ç¼–è¯‘çš„ç¨³å®šæ€§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%97%AE%E9%A2%98%E6%A0%B9%E5%9B%A0"><span class="nav-number">1.6.3.</span> <span class="nav-text">3. é—®é¢˜æ ¹å› </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%91%E6%8E%A7%E6%95%B0%E6%8D%AE"><span class="nav-number">1.6.4.</span> <span class="nav-text">ç›‘æ§æ•°æ®</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="nav-number">1.7.</span> <span class="nav-text">è§£å†³æ–¹æ¡ˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85-%E6%96%B9%E6%A1%88-1-%E4%BD%BF%E7%94%A8%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%A2%84%E7%BC%96%E8%AF%91-%E7%B4%A7%E5%87%91%E6%A0%BC%E5%BC%8F%EF%BC%88%E5%BC%BA%E7%83%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number">1.7.1.</span> <span class="nav-text">âœ… æ–¹æ¡ˆ 1: ä½¿ç”¨å®¢æˆ·ç«¯é¢„ç¼–è¯‘ + ç´§å‡‘æ ¼å¼ï¼ˆå¼ºçƒˆæ¨èï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%94%84-%E6%96%B9%E6%A1%88-2-%E4%BC%98%E5%8C%96-SQL-%E6%A0%BC%E5%BC%8F%EF%BC%88%E5%A6%82%E6%9E%9C%E5%BF%85%E9%A1%BB%E4%BD%BF%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E9%A2%84%E7%BC%96%E8%AF%91%EF%BC%89"><span class="nav-number">1.7.2.</span> <span class="nav-text">ğŸ”„ æ–¹æ¡ˆ 2: ä¼˜åŒ– SQL æ ¼å¼ï¼ˆå¦‚æœå¿…é¡»ä½¿ç”¨æœåŠ¡å™¨ç«¯é¢„ç¼–è¯‘ï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%94%A7-%E6%96%B9%E6%A1%88-3-%E5%88%86%E6%89%B9%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.7.3.</span> <span class="nav-text">ğŸ”§ æ–¹æ¡ˆ 3: åˆ†æ‰¹æŸ¥è¯¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%97%83%EF%B8%8F-%E6%96%B9%E6%A1%88-4-%E4%B8%B4%E6%97%B6%E8%A1%A8%E6%96%B9%E6%A1%88"><span class="nav-number">1.7.4.</span> <span class="nav-text">ğŸ—ƒï¸ æ–¹æ¡ˆ 4: ä¸´æ—¶è¡¨æ–¹æ¡ˆ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-number">1.8.</span> <span class="nav-text">æœ€ä½³å®è·µ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85-%E6%8E%A8%E8%8D%90%E9%85%8D%E7%BD%AE"><span class="nav-number">1.8.1.</span> <span class="nav-text">âœ… æ¨èé…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9D%8C-%E9%81%BF%E5%85%8D%E9%85%8D%E7%BD%AE"><span class="nav-number">1.8.2.</span> <span class="nav-text">âŒ é¿å…é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8E%AF-%E5%AE%9E%E6%96%BD%E5%BB%BA%E8%AE%AE"><span class="nav-number">1.8.3.</span> <span class="nav-text">ğŸ¯ å®æ–½å»ºè®®</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%8C%E6%95%B4%E5%AF%B9%E6%AF%94%E8%A1%A8"><span class="nav-number">1.9.</span> <span class="nav-text">å®Œæ•´å¯¹æ¯”è¡¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E6%94%B9%E5%96%84%E6%80%BB%E7%BB%93"><span class="nav-number">1.10.</span> <span class="nav-text">æ€§èƒ½æ”¹å–„æ€»ç»“</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-number">1.11.</span> <span class="nav-text">ç»“è®º</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81%E4%BB%93%E5%BA%93"><span class="nav-number">1.12.</span> <span class="nav-text">æµ‹è¯•ä»£ç ä»“åº“</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">twitter @plantegg</p>
  <div class="site-description" itemprop="description">java mysql tcp performance network docker Linux</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">190</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">282</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://plantegg.github.io/2025/11/05/MySQL_PreparedStatement_Performance_Issue_Reproduction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="twitter @plantegg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="plantegg">
      <meta itemprop="description" content="java mysql tcp performance network docker Linux">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="MySQL PreparedStatement æ€§èƒ½é—®é¢˜é‡ç° | plantegg">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL PreparedStatement æ€§èƒ½é—®é¢˜é‡ç°
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-11-05 17:30:03" itemprop="dateCreated datePublished" datetime="2025-11-05T17:30:03+08:00">2025-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-11-29 15:45:36" itemprop="dateModified" datetime="2025-11-29T15:45:36+08:00">2025-11-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="MySQL-PreparedStatement-æ€§èƒ½é—®é¢˜é‡ç°"><a href="#MySQL-PreparedStatement-æ€§èƒ½é—®é¢˜é‡ç°" class="headerlink" title="MySQL PreparedStatement æ€§èƒ½é—®é¢˜é‡ç°"></a>MySQL PreparedStatement æ€§èƒ½é—®é¢˜é‡ç°</h1><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‘ç°ï¼Œå½“ä½¿ç”¨ <code>useServerPrepStmts=true</code> å‚æ•°æ—¶ï¼ŒåŒ…å«å¤§é‡å‚æ•°çš„ PreparedStatement æŸ¥è¯¢æ€§èƒ½æå·®ã€‚é€šè¿‡ç³»ç»Ÿæµ‹è¯•å‘ç°ï¼Œ<strong>SQL æ ¼å¼å’Œé•¿åº¦å¯¹æ€§èƒ½æœ‰å·¨å¤§å½±å“</strong>ã€‚</p>
<p>åªéœ€è¦ä¸€ä¸ªç©ºè¡¨å°±èƒ½ç¨³å®šé‡ç°è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç»™å®˜æ–¹æäº¤ bug äº†</p>
<h2 id="ç¯å¢ƒä¿¡æ¯"><a href="#ç¯å¢ƒä¿¡æ¯" class="headerlink" title="ç¯å¢ƒä¿¡æ¯"></a>ç¯å¢ƒä¿¡æ¯</h2><ul>
<li><strong>MySQLç‰ˆæœ¬</strong>: 5.7.29</li>
<li><strong>JDBCé©±åŠ¨</strong>: mysql-connector-j-8.0.33</li>
<li><strong>æµ‹è¯•åœºæ™¯</strong>: 5ä¸‡ä¸ªå¤§æ•´æ•°å‚æ•°çš„ IN æŸ¥è¯¢</li>
<li><strong>å‚æ•°æ ¼å¼</strong>: 15ä½å¤§æ•´æ•°ï¼ˆå¦‚ 176302640511975ï¼‰</li>
<li><strong>é‡ç°ä»£ç </strong>: <a target="_blank" rel="noopener" href="https://github.com/plantegg/MySQLPrepared">https://github.com/plantegg/MySQLPrepared</a></li>
</ul>
<h2 id="æ ¸å¿ƒå‘ç°"><a href="#æ ¸å¿ƒå‘ç°" class="headerlink" title="æ ¸å¿ƒå‘ç°"></a>æ ¸å¿ƒå‘ç°</h2><h3 id="ğŸ”¥-SQL-æ ¼å¼å¯¹æ€§èƒ½çš„å·¨å¤§å½±å“"><a href="#ğŸ”¥-SQL-æ ¼å¼å¯¹æ€§èƒ½çš„å·¨å¤§å½±å“" class="headerlink" title="ğŸ”¥ SQL æ ¼å¼å¯¹æ€§èƒ½çš„å·¨å¤§å½±å“"></a>ğŸ”¥ SQL æ ¼å¼å¯¹æ€§èƒ½çš„å·¨å¤§å½±å“</h3><p>æˆ‘ä»¬å‘ç° <strong>SQL å­—ç¬¦ä¸²çš„æ ¼å¼å’Œé•¿åº¦</strong> æ˜¯å½±å“æœåŠ¡å™¨ç«¯é¢„ç¼–è¯‘æ€§èƒ½çš„å…³é”®å› ç´ ï¼š</p>
<table>
<thead>
<tr>
<th>SQLæ ¼å¼</th>
<th>SQLé•¿åº¦</th>
<th>falseå¹³å‡æ—¶é—´</th>
<th>trueå¹³å‡æ—¶é—´</th>
<th>æ€§èƒ½å·®å¼‚</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ç´§å‡‘æ ¼å¼</strong> (?,?,?)</td>
<td><strong>100KB</strong></td>
<td><strong>35ms</strong></td>
<td><strong>645ms</strong></td>
<td><strong>æ…¢18å€</strong> â­ æœ€ä¼˜</td>
</tr>
<tr>
<td>å¸¦æ¢è¡Œæ ¼å¼</td>
<td>2.1MB</td>
<td>47ms</td>
<td>9,128ms</td>
<td>æ…¢194å€</td>
</tr>
<tr>
<td>å¸¦æ¢è¡Œ+ç©ºæ ¼ (128)</td>
<td>6.5MB</td>
<td>52ms</td>
<td>27,839ms</td>
<td>æ…¢535å€</td>
</tr>
<tr>
<td>å¸¦æ¢è¡Œ+å¤§é‡ç©ºæ ¼ (128)</td>
<td>8.5MB</td>
<td>62ms</td>
<td>44,521ms</td>
<td>æ…¢712å€ ğŸ”¥ æœ€å·®</td>
</tr>
</tbody></table>
<p><strong>å…³é”®ç»“è®º</strong>: </p>
<ul>
<li>âœ… <strong>æœ€ä¼˜åŒ–çš„ç´§å‡‘æ ¼å¼</strong> å¯ä»¥å°†æœåŠ¡å™¨ç«¯æ€§èƒ½æå‡ <strong>14å€</strong>ï¼ˆ9,128ms â†’ 645msï¼‰</li>
<li>âš ï¸ å³ä½¿ä¼˜åŒ–åï¼Œå®¢æˆ·ç«¯é¢„ç¼–è¯‘ï¼ˆ35msï¼‰ä»æ¯”æœåŠ¡å™¨ç«¯ï¼ˆ645msï¼‰å¿« <strong>18å€</strong></li>
</ul>
<h2 id="é‡ç°æ­¥éª¤"><a href="#é‡ç°æ­¥éª¤" class="headerlink" title="é‡ç°æ­¥éª¤"></a>é‡ç°æ­¥éª¤</h2><h3 id="1-ç¯å¢ƒå‡†å¤‡"><a href="#1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1. ç¯å¢ƒå‡†å¤‡"></a>1. ç¯å¢ƒå‡†å¤‡</h3><p>åˆ›å»ºæµ‹è¯•è¡¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h your-host -P your-port -u your-user -p your-database &lt; create_table.sql</span><br></pre></td></tr></table></figure>

<p><code>create_table.sql</code> å†…å®¹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `large_table`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `large_table` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">  `col1` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">COLLATE</span> utf8_unicode_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `col2` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">COLLATE</span> utf8_unicode_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="comment">-- ... col3-col19 ...</span></span><br><span class="line">  `col20` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">COLLATE</span> utf8_unicode_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_unicode_ci;</span><br></pre></td></tr></table></figure>

<h3 id="2-è¿è¡Œæµ‹è¯•"><a href="#2-è¿è¡Œæµ‹è¯•" class="headerlink" title="2. è¿è¡Œæµ‹è¯•"></a>2. è¿è¡Œæµ‹è¯•</h3><h4 id="ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰"><a href="#ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰" class="headerlink" title="ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰"></a>ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœ€ä¼˜é…ç½®ï¼ˆç´§å‡‘æ ¼å¼ï¼‰</span></span><br><span class="line">./run_test.sh --host localhost --port 3306 --database <span class="built_in">test</span> \</span><br><span class="line">  --user root --password mypass --spaces 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•ä¸åŒç©ºæ ¼é…ç½®çš„å½±å“</span></span><br><span class="line">./run_test.sh --host localhost --port 3306 --database <span class="built_in">test</span> \</span><br><span class="line">  --user root --password mypass --spaces 128</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¸®åŠ©</span></span><br><span class="line">./run_test.sh --<span class="built_in">help</span></span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨-Maven"><a href="#ä½¿ç”¨-Maven" class="headerlink" title="ä½¿ç”¨ Maven"></a>ä½¿ç”¨ Maven</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mvn compile <span class="built_in">exec</span>:java \</span><br><span class="line">    -Dexec.mainClass=<span class="string">&quot;com.test.PreparedStatementPerformanceTest&quot;</span> \</span><br><span class="line">    -Ddb.host=localhost \</span><br><span class="line">    -Ddb.port=3306 \</span><br><span class="line">    -Ddb.name=<span class="built_in">test</span> \</span><br><span class="line">    -Ddb.user=root \</span><br><span class="line">    -Ddb.password=mypassword \</span><br><span class="line">    -Dparam.spaces=0</span><br></pre></td></tr></table></figure>

<h3 id="3-å‚æ•°è¯´æ˜"><a href="#3-å‚æ•°è¯´æ˜" class="headerlink" title="3. å‚æ•°è¯´æ˜"></a>3. å‚æ•°è¯´æ˜</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>é»˜è®¤å€¼</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>--spaces</code></td>
<td>128</td>
<td>å‚æ•°ä¹‹é—´çš„ç©ºæ ¼æ•°é‡ï¼Œ0&#x3D;æœ€ç´§å‡‘æ ¼å¼</td>
</tr>
<tr>
<td><code>--rounds</code></td>
<td>2</td>
<td>æµ‹è¯•è½®æ¬¡</td>
</tr>
</tbody></table>
<h2 id="è¯¦ç»†æµ‹è¯•ç»“æœ"><a href="#è¯¦ç»†æµ‹è¯•ç»“æœ" class="headerlink" title="è¯¦ç»†æµ‹è¯•ç»“æœ"></a>è¯¦ç»†æµ‹è¯•ç»“æœ</h2><h3 id="æµ‹è¯•-1-ç´§å‡‘æ ¼å¼-spaces-0-â­-æ¨è"><a href="#æµ‹è¯•-1-ç´§å‡‘æ ¼å¼-spaces-0-â­-æ¨è" class="headerlink" title="æµ‹è¯• 1: ç´§å‡‘æ ¼å¼ (spaces&#x3D;0) â­ æ¨è"></a>æµ‹è¯• 1: ç´§å‡‘æ ¼å¼ (spaces&#x3D;0) â­ æ¨è</h3><p><strong>SQL ç¤ºä¾‹</strong>: <code>WHERE id IN (?,?,?,?,...)</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®: useServerPrepStmts=false</span><br><span class="line">SQLé•¿åº¦: 100,151 å­—ç¬¦ (~100KB)</span><br><span class="line">å¹³å‡æ‰§è¡Œæ—¶é—´: 35.0ms</span><br><span class="line">Com_stmt_prepare: 0</span><br><span class="line"></span><br><span class="line">é…ç½®: useServerPrepStmts=true  </span><br><span class="line">SQLé•¿åº¦: 100,151 å­—ç¬¦ (~100KB)</span><br><span class="line">å¹³å‡æ‰§è¡Œæ—¶é—´: 645.5ms</span><br><span class="line">Com_stmt_prepare: 1</span><br><span class="line"></span><br><span class="line">æ€§èƒ½å·®å¼‚: æ…¢ 18 å€</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•-2-å¸¦æ¢è¡Œæ ¼å¼-æ—§ç‰ˆæœ¬"><a href="#æµ‹è¯•-2-å¸¦æ¢è¡Œæ ¼å¼-æ—§ç‰ˆæœ¬" class="headerlink" title="æµ‹è¯• 2: å¸¦æ¢è¡Œæ ¼å¼ (æ—§ç‰ˆæœ¬)"></a>æµ‹è¯• 2: å¸¦æ¢è¡Œæ ¼å¼ (æ—§ç‰ˆæœ¬)</h3><p><strong>SQL ç¤ºä¾‹</strong>: </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> id <span class="keyword">IN</span> (?</span><br><span class="line">                  ,</span><br><span class="line">                    ?</span><br><span class="line">                  ,</span><br><span class="line">                    ?</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®: useServerPrepStmts=false</span><br><span class="line">SQLé•¿åº¦: 2,100,111 å­—ç¬¦ (~2.1MB)</span><br><span class="line">å¹³å‡æ‰§è¡Œæ—¶é—´: 47.0ms</span><br><span class="line">Com_stmt_prepare: 0</span><br><span class="line"></span><br><span class="line">é…ç½®: useServerPrepStmts=true</span><br><span class="line">SQLé•¿åº¦: 2,100,111 å­—ç¬¦ (~2.1MB)</span><br><span class="line">å¹³å‡æ‰§è¡Œæ—¶é—´: 9,128.5ms</span><br><span class="line">Com_stmt_prepare: 1</span><br><span class="line"></span><br><span class="line">æ€§èƒ½å·®å¼‚: æ…¢ 194 å€</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•-3-å¸¦ç©ºæ ¼æ ¼å¼-spaces-128"><a href="#æµ‹è¯•-3-å¸¦ç©ºæ ¼æ ¼å¼-spaces-128" class="headerlink" title="æµ‹è¯• 3: å¸¦ç©ºæ ¼æ ¼å¼ (spaces&#x3D;128)"></a>æµ‹è¯• 3: å¸¦ç©ºæ ¼æ ¼å¼ (spaces&#x3D;128)</h3><p><strong>SQL ç¤ºä¾‹</strong>: <code>WHERE id IN (?,&lt;128 spaces&gt;?,&lt;128 spaces&gt;?,...)</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®: useServerPrepStmts=false</span><br><span class="line">SQLé•¿åº¦: 6,500,023 å­—ç¬¦ (~6.5MB)</span><br><span class="line">å¹³å‡æ‰§è¡Œæ—¶é—´: 52.0ms</span><br><span class="line">Com_stmt_prepare: 0</span><br><span class="line"></span><br><span class="line">é…ç½®: useServerPrepStmts=true</span><br><span class="line">SQLé•¿åº¦: 6,500,023 å­—ç¬¦ (~6.5MB)</span><br><span class="line">å¹³å‡æ‰§è¡Œæ—¶é—´: 27,839.5ms</span><br><span class="line">Com_stmt_prepare: 1</span><br><span class="line"></span><br><span class="line">æ€§èƒ½å·®å¼‚: æ…¢ 535 å€</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•-4-å¸¦æ¢è¡Œ-å¤§é‡ç©ºæ ¼-æç«¯æƒ…å†µ"><a href="#æµ‹è¯•-4-å¸¦æ¢è¡Œ-å¤§é‡ç©ºæ ¼-æç«¯æƒ…å†µ" class="headerlink" title="æµ‹è¯• 4: å¸¦æ¢è¡Œ+å¤§é‡ç©ºæ ¼ (æç«¯æƒ…å†µ)"></a>æµ‹è¯• 4: å¸¦æ¢è¡Œ+å¤§é‡ç©ºæ ¼ (æç«¯æƒ…å†µ)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®: useServerPrepStmts=false</span><br><span class="line">SQLé•¿åº¦: 8,499,983 å­—ç¬¦ (~8.5MB)</span><br><span class="line">å¹³å‡æ‰§è¡Œæ—¶é—´: 62.5ms</span><br><span class="line">Com_stmt_prepare: 0</span><br><span class="line"></span><br><span class="line">é…ç½®: useServerPrepStmts=true</span><br><span class="line">SQLé•¿åº¦: 8,499,983 å­—ç¬¦ (~8.5MB)</span><br><span class="line">å¹³å‡æ‰§è¡Œæ—¶é—´: 44,521.5ms</span><br><span class="line">Com_stmt_prepare: 1</span><br><span class="line"></span><br><span class="line">æ€§èƒ½å·®å¼‚: æ…¢ 712 å€</span><br></pre></td></tr></table></figure>

<h2 id="æ€§èƒ½åˆ†æ"><a href="#æ€§èƒ½åˆ†æ" class="headerlink" title="æ€§èƒ½åˆ†æ"></a>æ€§èƒ½åˆ†æ</h2><h3 id="1-SQL-é•¿åº¦ä¸æ€§èƒ½çš„çº¿æ€§å…³ç³»"><a href="#1-SQL-é•¿åº¦ä¸æ€§èƒ½çš„çº¿æ€§å…³ç³»" class="headerlink" title="1. SQL é•¿åº¦ä¸æ€§èƒ½çš„çº¿æ€§å…³ç³»"></a>1. SQL é•¿åº¦ä¸æ€§èƒ½çš„çº¿æ€§å…³ç³»</h3><p>æœåŠ¡å™¨ç«¯é¢„ç¼–è¯‘æ€§èƒ½éš SQL é•¿åº¦çº¿æ€§æ¶åŒ–ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">100KB  SQL â†’ 645ms    (åŸºå‡†)</span><br><span class="line">2.1MB  SQL â†’ 9,128ms  (14å€æ¶åŒ–)</span><br><span class="line">6.5MB  SQL â†’ 27,839ms (43å€æ¶åŒ–)</span><br><span class="line">8.5MB  SQL â†’ 44,521ms (69å€æ¶åŒ–)</span><br></pre></td></tr></table></figure>

<h3 id="2-å®¢æˆ·ç«¯é¢„ç¼–è¯‘çš„ç¨³å®šæ€§"><a href="#2-å®¢æˆ·ç«¯é¢„ç¼–è¯‘çš„ç¨³å®šæ€§" class="headerlink" title="2. å®¢æˆ·ç«¯é¢„ç¼–è¯‘çš„ç¨³å®šæ€§"></a>2. å®¢æˆ·ç«¯é¢„ç¼–è¯‘çš„ç¨³å®šæ€§</h3><p>å®¢æˆ·ç«¯é¢„ç¼–è¯‘å‡ ä¹ä¸å— SQL é•¿åº¦å½±å“ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">100KB  SQL â†’ 35-47ms</span><br><span class="line">8.5MB  SQL â†’ 62ms</span><br><span class="line">å˜åŒ–å¹…åº¦: ä»… 77%</span><br></pre></td></tr></table></figure>

<h3 id="3-é—®é¢˜æ ¹å› "><a href="#3-é—®é¢˜æ ¹å› " class="headerlink" title="3. é—®é¢˜æ ¹å› "></a>3. é—®é¢˜æ ¹å› </h3><p>æ ¹æ® <code>pstack</code> åˆ†æï¼ŒæœåŠ¡å™¨ç«¯é¢„ç¼–è¯‘åœ¨å¤„ç†å¤§ SQL æ—¶ï¼š</p>
<ol>
<li><p><strong>å¤§é‡å†…å­˜é‡åˆ†é…</strong>: </p>
<ul>
<li>50,000 æ¬¡å‚æ•°æ›¿æ¢æ“ä½œ</li>
<li>æ¯æ¬¡æ›¿æ¢éœ€è¦åœ¨å¤§ SQL å­—ç¬¦ä¸²ä¸­å®šä½å’Œæ›¿æ¢</li>
<li><code>my_realloc</code> å’Œ <code>memmove</code> é¢‘ç¹è°ƒç”¨</li>
</ul>
</li>
<li><p><strong>å­—ç¬¦ä¸²æ“ä½œå¤æ‚åº¦</strong>: </p>
<ul>
<li>O(SQLé•¿åº¦) Ã— å‚æ•°æ•°é‡ &#x3D; æé«˜æ—¶é—´å¤æ‚åº¦</li>
<li>å•çº¿ç¨‹ 100% CPU å ç”¨</li>
</ul>
</li>
<li><p><strong>å†…å­˜ç¢ç‰‡åŒ–</strong>:</p>
<ul>
<li>é¢‘ç¹çš„å¤§å—å†…å­˜åˆ†é…å’Œé‡Šæ”¾</li>
<li>è¿›ä¸€æ­¥é™ä½æ€§èƒ½</li>
</ul>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Thread 1 (Thread 0x7feeb8043640 (LWP 2508284)):</span><br><span class="line">#0  0x00007ff302bb5515 in __memmove_avx512_unaligned_erms () from /lib64/libc.so.6</span><br><span class="line">#1  0x0000000000efffe6 in my_realloc (key=&lt;optimized out&gt;, ptr=0x7fee5e907380, size=7192160, flags=&lt;optimized out&gt;) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/mysys/my_malloc.c:112</span><br><span class="line">#2  0x0000000000d9a921 in String::mem_realloc (this=0x7feeb80424b0, alloc_length=7192155, force_on_heap=force_on_heap@entry=false) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/sql-common/sql_string.cc:128</span><br><span class="line">#3  0x0000000000d9b9d4 in String::replace (this=this@entry=0x7feeb80424b0, offset=7119079, arg_length=arg_length@entry=1, to=0x7fee5c3f5810 &quot;286381588518215&quot;, to_length=15) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/sql-common/sql_string.cc:804</span><br><span class="line">#4  0x0000000000d9ba81 in String::replace (this=this@entry=0x7feeb80424b0, offset=&lt;optimized out&gt;, arg_length=arg_length@entry=1, to=...) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/sql-common/sql_string.cc:783</span><br><span class="line">#5  0x0000000000d026e2 in Prepared_statement::insert_params (this=this@entry=0x7fee5c171fe0, null_array=null_array@entry=0x7fee5c45240a &quot;&quot;, read_pos=0x7fee5c4ccc05 &quot;\336\274y\206&quot;, &lt;incomplete sequence \303&gt;, read_pos@entry=0x7fee5c46c315 &quot;\016r\342\320\355\242\002&quot;, data_end=0x7fee5c4cdd95 &quot;&quot;, query=query@entry=0x7feeb80424b0) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/sql/sql_prepare.cc:924</span><br><span class="line">#6  0x0000000000d03db6 in Prepared_statement::set_parameters (this=this@entry=0x7fee5c171fe0, expanded_query=expanded_query@entry=0x7feeb80424b0, packet=0x7fee5c46c315 &quot;\016r\342\320\355\242\002&quot;, packet_end=&lt;optimized out&gt;) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/sql/sql_prepare.cc:3496</span><br><span class="line">#7  0x0000000000d0772f in Prepared_statement::execute_loop (this=0x7fee5c171fe0, expanded_query=0x7feeb80424b0, open_cursor=&lt;optimized out&gt;, packet=&lt;optimized out&gt;, packet_end=&lt;optimized out&gt;) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/sql/sql_prepare.cc:3559</span><br><span class="line">#8  0x0000000000d07aa4 in mysqld_stmt_execute (thd=thd@entry=0x7fee5c000b60, stmt_id=&lt;optimized out&gt;, flags=0, params=0x7fee5c45240a &quot;&quot;, params_length=506251) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/sql/sql_prepare.cc:2582</span><br><span class="line">#9  0x0000000000cdf6f5 in dispatch_command (thd=thd@entry=0x7fee5c000b60, com_data=com_data@entry=0x7feeb8042d40, command=COM_STMT_EXECUTE) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/sql/sql_parse.cc:1428</span><br><span class="line">#10 0x0000000000ce00c7 in do_command (thd=thd@entry=0x7fee5c000b60) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/sql/sql_parse.cc:1032</span><br><span class="line">#11 0x0000000000d9cc08 in handle_connection (arg=arg@entry=0x1eb0a010) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/sql/conn_handler/connection_handler_per_thread.cc:313</span><br><span class="line">#12 0x00000000013fc4a4 in pfs_spawn_thread (arg=0x1ea71270) at /export/home/pb2/build/sb_0-37309218-1576676711.18/mysql-5.7.29/storage/perfschema/pfs.cc:2197</span><br><span class="line">#13 0x00007ff30305b3fb in start_thread () from /lib64/libpthread.so.0</span><br><span class="line">#14 0x00007ff302b0de83 in clone () from /lib64/libc.so.6</span><br></pre></td></tr></table></figure>

<h3 id="ç›‘æ§æ•°æ®"><a href="#ç›‘æ§æ•°æ®" class="headerlink" title="ç›‘æ§æ•°æ®"></a>ç›‘æ§æ•°æ®</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># top ç›‘æ§</span><br><span class="line">PID     USER   %CPU  TIME+     COMMAND</span><br><span class="line">2554029 mysql  99.3  4:40.64   mysqld  // å•çº¿ç¨‹ 100%</span><br><span class="line"></span><br><span class="line"># show processlist è§‚å¯Ÿ</span><br><span class="line">Id  User  Command  Time  State     Info</span><br><span class="line">382 test  Execute  8     starting  NULL  // SQL è¿˜åœ¨ç»„è£…ä¸­</span><br></pre></td></tr></table></figure>

<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><h3 id="âœ…-æ–¹æ¡ˆ-1-ä½¿ç”¨å®¢æˆ·ç«¯é¢„ç¼–è¯‘-ç´§å‡‘æ ¼å¼ï¼ˆå¼ºçƒˆæ¨èï¼‰"><a href="#âœ…-æ–¹æ¡ˆ-1-ä½¿ç”¨å®¢æˆ·ç«¯é¢„ç¼–è¯‘-ç´§å‡‘æ ¼å¼ï¼ˆå¼ºçƒˆæ¨èï¼‰" class="headerlink" title="âœ… æ–¹æ¡ˆ 1: ä½¿ç”¨å®¢æˆ·ç«¯é¢„ç¼–è¯‘ + ç´§å‡‘æ ¼å¼ï¼ˆå¼ºçƒˆæ¨èï¼‰"></a>âœ… æ–¹æ¡ˆ 1: ä½¿ç”¨å®¢æˆ·ç«¯é¢„ç¼–è¯‘ + ç´§å‡‘æ ¼å¼ï¼ˆå¼ºçƒˆæ¨èï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JDBC è¿æ¥ä¸²</span></span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://host:port/database?useServerPrepStmts=false&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿è¡Œæµ‹è¯•</span></span><br><span class="line">./run_test.sh --host localhost --port <span class="number">3306</span> --database test \</span><br><span class="line">  --user root --password mypass --spaces <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p><strong>ä¼˜ç‚¹</strong>:</p>
<ul>
<li>âœ… æ€§èƒ½æœ€ä¼˜ï¼šä»…éœ€ 35ms</li>
<li>âœ… ä¸å— SQL é•¿åº¦å½±å“</li>
<li>âœ… ä¸å—å‚æ•°æ•°é‡å½±å“</li>
<li>âœ… ç¨³å®šå¯é </li>
</ul>
<p><strong>ç¼ºç‚¹</strong>:</p>
<ul>
<li>âš ï¸ æ— æ³•äº«å—æœåŠ¡å™¨ç«¯æŸ¥è¯¢è®¡åˆ’ç¼“å­˜ï¼ˆä½†å¯¹ IN æŸ¥è¯¢æ„ä¹‰ä¸å¤§ï¼‰</li>
</ul>
<h3 id="ğŸ”„-æ–¹æ¡ˆ-2-ä¼˜åŒ–-SQL-æ ¼å¼ï¼ˆå¦‚æœå¿…é¡»ä½¿ç”¨æœåŠ¡å™¨ç«¯é¢„ç¼–è¯‘ï¼‰"><a href="#ğŸ”„-æ–¹æ¡ˆ-2-ä¼˜åŒ–-SQL-æ ¼å¼ï¼ˆå¦‚æœå¿…é¡»ä½¿ç”¨æœåŠ¡å™¨ç«¯é¢„ç¼–è¯‘ï¼‰" class="headerlink" title="ğŸ”„ æ–¹æ¡ˆ 2: ä¼˜åŒ– SQL æ ¼å¼ï¼ˆå¦‚æœå¿…é¡»ä½¿ç”¨æœåŠ¡å™¨ç«¯é¢„ç¼–è¯‘ï¼‰"></a>ğŸ”„ æ–¹æ¡ˆ 2: ä¼˜åŒ– SQL æ ¼å¼ï¼ˆå¦‚æœå¿…é¡»ä½¿ç”¨æœåŠ¡å™¨ç«¯é¢„ç¼–è¯‘ï¼‰</h3><p>å¦‚æœç”±äºæŸäº›åŸå› å¿…é¡»ä½¿ç”¨ <code>useServerPrepStmts=true</code>ï¼Œåˆ™åŠ¡å¿…ä¼˜åŒ– SQL æ ¼å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨æœ€ç´§å‡‘æ ¼å¼: ?,?,?,?</span></span><br><span class="line"><span class="comment">// é¿å…: ?\n  ,\n  ?</span></span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://host:port/database?useServerPrepStmts=true&quot;</span>;</span><br><span class="line"><span class="comment">// è¿è¡Œæ—¶ä½¿ç”¨ --spaces 0</span></span><br></pre></td></tr></table></figure>

<p><strong>æ€§èƒ½</strong>: 645msï¼ˆç›¸æ¯”æœªä¼˜åŒ–çš„ 9,128ms æå‡ 14 å€ï¼‰</p>
<h3 id="ğŸ”§-æ–¹æ¡ˆ-3-åˆ†æ‰¹æŸ¥è¯¢"><a href="#ğŸ”§-æ–¹æ¡ˆ-3-åˆ†æ‰¹æŸ¥è¯¢" class="headerlink" title="ğŸ”§ æ–¹æ¡ˆ 3: åˆ†æ‰¹æŸ¥è¯¢"></a>ğŸ”§ æ–¹æ¡ˆ 3: åˆ†æ‰¹æŸ¥è¯¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°† 50,000 ä¸ªå‚æ•°æ‹†åˆ†ä¸º 50 æ‰¹ï¼Œæ¯æ‰¹ 1,000 ä¸ª</span></span><br><span class="line"><span class="type">int</span> <span class="variable">batchSize</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; ids.size(); i += batchSize) &#123;</span><br><span class="line">    List&lt;Long&gt; batch = ids.subList(i, Math.min(i + batchSize, ids.size()));</span><br><span class="line">    <span class="comment">// æ‰§è¡ŒæŸ¥è¯¢</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ğŸ—ƒï¸-æ–¹æ¡ˆ-4-ä¸´æ—¶è¡¨æ–¹æ¡ˆ"><a href="#ğŸ—ƒï¸-æ–¹æ¡ˆ-4-ä¸´æ—¶è¡¨æ–¹æ¡ˆ" class="headerlink" title="ğŸ—ƒï¸ æ–¹æ¡ˆ 4: ä¸´æ—¶è¡¨æ–¹æ¡ˆ"></a>ğŸ—ƒï¸ æ–¹æ¡ˆ 4: ä¸´æ—¶è¡¨æ–¹æ¡ˆ</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> TEMPORARY <span class="keyword">TABLE</span> temp_ids (id <span class="type">BIGINT</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> temp_ids <span class="keyword">VALUES</span> (?), (?), ...;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> large_table <span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> temp_ids);</span><br><span class="line"><span class="keyword">DROP</span> TEMPORARY <span class="keyword">TABLE</span> temp_ids;</span><br></pre></td></tr></table></figure>

<h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><h3 id="âœ…-æ¨èé…ç½®"><a href="#âœ…-æ¨èé…ç½®" class="headerlink" title="âœ… æ¨èé…ç½®"></a>âœ… æ¨èé…ç½®</h3><table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>useServerPrepStmts</th>
<th>spaces</th>
<th>é¢„æœŸæ€§èƒ½</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ç”Ÿäº§ç¯å¢ƒ</strong></td>
<td>false</td>
<td>0</td>
<td>35ms â­ æœ€ä¼˜</td>
</tr>
<tr>
<td>æ ‡å‡†æµ‹è¯•</td>
<td>false</td>
<td>0</td>
<td>35-50ms</td>
</tr>
<tr>
<td>å¿…é¡»æœåŠ¡å™¨ç«¯é¢„ç¼–è¯‘</td>
<td>true</td>
<td>0</td>
<td>645ms</td>
</tr>
</tbody></table>
<h3 id="âŒ-é¿å…é…ç½®"><a href="#âŒ-é¿å…é…ç½®" class="headerlink" title="âŒ é¿å…é…ç½®"></a>âŒ é¿å…é…ç½®</h3><table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>useServerPrepStmts</th>
<th>SQLæ ¼å¼</th>
<th>æ€§èƒ½</th>
</tr>
</thead>
<tbody><tr>
<td>âŒ å¸¦æ ¼å¼åŒ–</td>
<td>true</td>
<td>å¸¦æ¢è¡Œ&#x2F;ç¼©è¿›</td>
<td>9,128ms æ…¢194å€</td>
</tr>
<tr>
<td>âŒ å¤§é‡ç©ºæ ¼</td>
<td>true</td>
<td>spaces &gt; 0</td>
<td>27,839ms æ…¢535å€</td>
</tr>
<tr>
<td>âŒ æç«¯æƒ…å†µ</td>
<td>true</td>
<td>å¤§é‡æ¢è¡Œ+ç©ºæ ¼</td>
<td>44,521ms æ…¢712å€</td>
</tr>
</tbody></table>
<h3 id="ğŸ¯-å®æ–½å»ºè®®"><a href="#ğŸ¯-å®æ–½å»ºè®®" class="headerlink" title="ğŸ¯ å®æ–½å»ºè®®"></a>ğŸ¯ å®æ–½å»ºè®®</h3><ol>
<li><p><strong>å¼€å‘é˜¶æ®µ</strong>:</p>
<ul>
<li>è®¾ç½® <code>useServerPrepStmts=false</code></li>
<li>ä½¿ç”¨ <code>--spaces 0</code> æµ‹è¯•</li>
</ul>
</li>
<li><p><strong>æµ‹è¯•é˜¶æ®µ</strong>:</p>
<ul>
<li>å¯¹æ¯”ä¸åŒé…ç½®çš„æ€§èƒ½</li>
<li>ä½¿ç”¨ <code>SHOW PROCESSLIST</code> ç›‘æ§</li>
</ul>
</li>
<li><p><strong>ç”Ÿäº§ç¯å¢ƒ</strong>:</p>
<ul>
<li>å¼ºåˆ¶ä½¿ç”¨å®¢æˆ·ç«¯é¢„ç¼–è¯‘</li>
<li>é¿å…å¤§å‚æ•°é‡ IN æŸ¥è¯¢</li>
<li>å¦‚å¿…é¡»ä½¿ç”¨ï¼Œè€ƒè™‘åˆ†æ‰¹æˆ–ä¸´æ—¶è¡¨æ–¹æ¡ˆ</li>
</ul>
</li>
</ol>
<h2 id="å®Œæ•´å¯¹æ¯”è¡¨"><a href="#å®Œæ•´å¯¹æ¯”è¡¨" class="headerlink" title="å®Œæ•´å¯¹æ¯”è¡¨"></a>å®Œæ•´å¯¹æ¯”è¡¨</h2><table>
<thead>
<tr>
<th>é…ç½®</th>
<th>SQLæ ¼å¼</th>
<th>SQLé•¿åº¦</th>
<th>falseå¹³å‡</th>
<th>trueå¹³å‡</th>
<th>æ€§èƒ½å·®å¼‚</th>
</tr>
</thead>
<tbody><tr>
<td><strong>æœ€ä¼˜</strong></td>
<td>?,?,?</td>
<td>100KB</td>
<td>35ms</td>
<td>645ms</td>
<td>æ…¢18å€ â­</td>
</tr>
<tr>
<td>å¸¦æ¢è¡Œ</td>
<td>?\n,\n?</td>
<td>2.1MB</td>
<td>47ms</td>
<td>9,128ms</td>
<td>æ…¢194å€</td>
</tr>
<tr>
<td>+ç©ºæ ¼128</td>
<td>?,&lt;128&gt;?</td>
<td>6.5MB</td>
<td>52ms</td>
<td>27,839ms</td>
<td>æ…¢535å€</td>
</tr>
<tr>
<td>å¸¦æ¢è¡Œ+ç©ºæ ¼128</td>
<td>?\n,\n&lt;128&gt;?</td>
<td>8.5MB</td>
<td>62ms</td>
<td>44,521ms</td>
<td>æ…¢712å€ ğŸ”¥</td>
</tr>
</tbody></table>
<h2 id="æ€§èƒ½æ”¹å–„æ€»ç»“"><a href="#æ€§èƒ½æ”¹å–„æ€»ç»“" class="headerlink" title="æ€§èƒ½æ”¹å–„æ€»ç»“"></a>æ€§èƒ½æ”¹å–„æ€»ç»“</h2><p>é€šè¿‡ SQL æ ¼å¼ä¼˜åŒ–ï¼š</p>
<table>
<thead>
<tr>
<th>æŒ‡æ ‡</th>
<th>ä¼˜åŒ–å‰</th>
<th>ä¼˜åŒ–å</th>
<th>æ”¹å–„å¹…åº¦</th>
</tr>
</thead>
<tbody><tr>
<td>SQL é•¿åº¦</td>
<td>2.1MB</td>
<td>100KB</td>
<td><strong>ç¼©å° 95%</strong></td>
</tr>
<tr>
<td>æœåŠ¡å™¨ç«¯æ€§èƒ½</td>
<td>9,128ms</td>
<td>645ms</td>
<td><strong>æå‡ 14 å€</strong></td>
</tr>
<tr>
<td>æ€§èƒ½å·®å¼‚å€æ•°</td>
<td>194å€</td>
<td>18å€</td>
<td><strong>æ”¹å–„ 10 å€</strong></td>
</tr>
</tbody></table>
<p><strong>ä½†æœ€ç»ˆå»ºè®®</strong>: ä½¿ç”¨å®¢æˆ·ç«¯é¢„ç¼–è¯‘ï¼ˆ35msï¼‰æ‰æ˜¯æœ€ä½³æ–¹æ¡ˆï¼</p>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><ol>
<li><p><strong>SQL é•¿åº¦æ˜¯æœåŠ¡å™¨ç«¯é¢„ç¼–è¯‘çš„è‡´å‘½å¼±ç‚¹</strong></p>
<ul>
<li>é•¿åº¦å¢åŠ  â†’ æ€§èƒ½çº¿æ€§æ¶åŒ–</li>
<li>ä» 100KBï¼ˆ645msï¼‰åˆ° 8.5MBï¼ˆ44,521msï¼‰ï¼Œæ€§èƒ½ä¸‹é™ <strong>69 å€</strong></li>
</ul>
</li>
<li><p><strong>SQL æ ¼å¼ä¼˜åŒ–å¾ˆé‡è¦</strong></p>
<ul>
<li>ç§»é™¤æ¢è¡Œå’Œå¤šä½™ç©ºæ ¼å¯æå‡æ€§èƒ½ <strong>14 å€</strong></li>
<li>ä½¿ç”¨ <code>--spaces 0</code> è·å¾—æœ€ç´§å‡‘æ ¼å¼</li>
</ul>
</li>
<li><p><strong>å®¢æˆ·ç«¯é¢„ç¼–è¯‘å‡ ä¹ä¸å—å½±å“</strong></p>
<ul>
<li>100KB SQL: 35ms</li>
<li>8.5MB SQL: 62ms  </li>
<li>æ€§èƒ½ç¨³å®šå¯é </li>
</ul>
</li>
<li><p><strong>ç”Ÿäº§ç¯å¢ƒå¼ºçƒˆå»ºè®®</strong></p>
<ul>
<li>âœ… ä½¿ç”¨ <code>useServerPrepStmts=false</code></li>
<li>âœ… ä½¿ç”¨æœ€ç´§å‡‘çš„ SQL æ ¼å¼ï¼ˆ<code>--spaces 0</code>ï¼‰</li>
<li>âœ… é¿å…å¤§å‚æ•°é‡ IN æŸ¥è¯¢ï¼Œæˆ–ä½¿ç”¨åˆ†æ‰¹&#x2F;ä¸´æ—¶è¡¨æ–¹æ¡ˆ</li>
</ul>
</li>
<li><p><strong>æ€§èƒ½å·®å¼‚</strong></p>
<ul>
<li>æœ€ä¼˜é…ç½®ï¼ˆ35msï¼‰vs æœ€å·®é…ç½®ï¼ˆ44,521msï¼‰&#x3D; <strong>1,272 å€å·®å¼‚</strong>ï¼</li>
<li>è¿™ä¸æ˜¯ä¼˜åŒ–é—®é¢˜ï¼Œè€Œæ˜¯æ¶æ„é€‰æ‹©é—®é¢˜</li>
</ul>
</li>
</ol>
<h2 id="æµ‹è¯•ä»£ç ä»“åº“"><a href="#æµ‹è¯•ä»£ç ä»“åº“" class="headerlink" title="æµ‹è¯•ä»£ç ä»“åº“"></a>æµ‹è¯•ä»£ç ä»“åº“</h2><ul>
<li>GitHub: <a target="_blank" rel="noopener" href="https://github.com/plantegg/MySQLPrepared">https://github.com/plantegg/MySQLPrepared</a></li>
<li>åŒ…å«å®Œæ•´çš„æµ‹è¯•ä»£ç ã€è„šæœ¬å’Œæ–‡æ¡£</li>
<li>æ”¯æŒ <code>--spaces</code> å‚æ•°çµæ´»æµ‹è¯•ä¸åŒ SQL æ ¼å¼</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
              <a href="/tags/PreparedStatement/" rel="tag"># PreparedStatement</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/10/25/AWS_RDS_BlueGreen_Upgrade_Guide/" rel="prev" title="AWS RDS MySQL è“ç»¿éƒ¨ç½²å‡çº§å®Œæ•´æŒ‡å—">
                  <i class="fa fa-angle-left"></i> AWS RDS MySQL è“ç»¿éƒ¨ç½²å‡çº§å®Œæ•´æŒ‡å—
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/11/29/mysql_sysbench_v2/" rel="next" title="äº‘ç›˜å’Œæœ¬åœ°ç›˜è°å¼ºï¼Ÿå„å®¶äº‘å‚å•†äº‘ç›˜è°æ›´å¼ºï¼Ÿ">
                  äº‘ç›˜å’Œæœ¬åœ°ç›˜è°å¼ºï¼Ÿå„å®¶äº‘å‚å•†äº‘ç›˜è°æ›´å¼ºï¼Ÿ <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2026</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">twitter @plantegg</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
